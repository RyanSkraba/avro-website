<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.80.0" /><link rel="canonical" type="text/html" href="/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/index.xml">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Documentation | Apache Avro</title>


  
  <meta name="description" content="Introduction
Apache Avro™ is a data serialization system.
Avro provides:

Rich data structures.
A compact, fast, binary data format.
A container file, …">
<meta property="og:title" content="Documentation" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/" />
<meta property="og:site_name" content="Apache Avro" />
<meta itemprop="name" content="Documentation">
<meta itemprop="description" content="">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documentation"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="/scss/main.min.30d73e35c90f654c060d7e7add9a2e7c0ba6dad30372ff7416b222681b7b4652.css" as="style">
<link href="/scss/main.min.30d73e35c90f654c060d7e7add9a2e7c0ba6dad30372ff7416b222681b7b4652.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="/css/prism.css"/>











  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">Apache Avro</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Documentation</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-6e17e09fffc1050f46600282def85180">Overview</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-5f51c0d9befcc514c3187890e479c40f">Getting Started (Java)</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-2866df17a036e782ff79002b5a739d03">Getting Started (Python)</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-e21debf31b9dce92de3692d7c2eac94d">Specification</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-855fa3456d5ec5677548590b68db0334">Java API</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-f288c30677a180f69252f486fe9fe630">C API</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-e2d3067f4d925eb37135a13ed88d2428">Core Tasks</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>7.1: <a href="#pg-525d55e5e5eaf1ca7138046ef31cd022">Bed and Chair Metrics</a></li>


    
  
    
    
	
<li>7.2: <a href="#pg-8b9ed72c94082e62654acbe5544809a4">Porridge Assessment</a></li>


    
  
    
    
	
<li>7.3: <a href="#pg-2acd4be46aab21e87082be97de87c74d">Another Task</a></li>


    
  
    
    
	
<li>7.4: <a href="#pg-013e157738e63d8c3f90b39d559e8c8d">Working with Ponycopters</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>7.4.1: <a href="#pg-ab480eb0e8e417eb7cd925a592e0cbcc">Configuring Ponycopters</a></li>


    
  
    
    
	
<li>7.4.2: <a href="#pg-3662f29ce4d0c9029454f98cd85d98ca">Launching Ponycopters</a></li>


    
  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>8: <a href="#pg-8dbd4e302cd86a4d0f71f71ce3b300de">Tutorials</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>8.1: <a href="#pg-06285b237e6e217b13f8d9c941a9de18">Multi-Bear Domicile Setup</a></li>


    
  
    
    
	
<li>8.2: <a href="#pg-c86b0cbc9ee1f95a6facb6bff0282978">Another Tutorial</a></li>


    
  

    </ul>
    
  
    
    
	
<li>9: <a href="#pg-8df6ea6904416b571ff9bc73afb50933">Reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>9.1: <a href="#pg-fae1ff8e3c30cfdbe85045f64e0a7b36">Parameter Reference</a></li>


    
  

    </ul>
    
  
    
    
	
<li>10: <a href="#pg-8efbf7499fe9c7bde8d2c1bb7ff6ee3c">Contribution Guidelines</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      <h2 id="introduction">Introduction</h2>
<p>Apache Avro™ is a data serialization system.</p>
<p>Avro provides:</p>
<ul>
<li>Rich data structures.</li>
<li>A compact, fast, binary data format.</li>
<li>A container file, to store persistent data.</li>
<li>Remote procedure call (RPC).</li>
<li>Simple integration with dynamic languages. Code generation is not required to read or write data files nor to use or implement RPC protocols. Code generation as an optional optimization, only worth implementing for statically typed languages.</li>
</ul>
<h2 id="schemas">Schemas</h2>
<p>Avro relies on schemas. When Avro data is read, the schema used when writing it is always present. This permits each datum to be written with no per-value overheads, making serialization both fast and small. This also facilitates use with dynamic, scripting languages, since data, together with its schema, is fully self-describing.</p>
<p>When Avro data is stored in a file, its schema is stored with it, so that files may be processed later by any program. If the program reading the data expects a different schema this can be easily resolved, since both schemas are present.</p>
<p>When Avro is used in RPC, the client and server exchange schemas in the connection handshake. (This can be optimized so that, for most calls, no schemas are actually transmitted.) Since both client and server both have the other&rsquo;s full schema, correspondence between same named fields, missing fields, extra fields, etc. can all be easily resolved.</p>
<p>Avro schemas are defined with JSON . This facilitates implementation in languages that already have JSON libraries.</p>
<h2 id="comparison-with-other-systems">Comparison with other systems</h2>
<p>Avro provides functionality similar to systems such as <a href="https://thrift.apache.org/">Thrift</a>, <a href="https://code.google.com/p/protobuf/">Protocol Buffers</a>, etc. Avro differs from these systems in the following fundamental aspects.</p>
<ul>
<li>Dynamic typing: Avro does not require that code be generated. Data is always accompanied by a schema that permits full processing of that data without code generation, static datatypes, etc. This facilitates construction of generic data-processing systems and languages.</li>
<li>Untagged data: Since the schema is present when data is read, considerably less type information need be encoded with data, resulting in smaller serialization size.</li>
<li>No manually-assigned field IDs: When a schema changes, both the old and new schema are always present when processing data, so differences may be resolved symbolically, using field names.</li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6e17e09fffc1050f46600282def85180">1 - Overview</h1>
    <div class="lead">Here&rsquo;s where your user finds out if your project is for them.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page that shows you how to use this template site.</p>

</div>

<p>The Overview is where your users find out about your project. Depending on the size of your docset, you can have a separate overview page (like this one) or put your overview contents in the Documentation landing page (like in the Docsy User Guide).</p>
<p>Try answering these questions for your user in this page:</p>
<h2 id="what-is-it">What is it?</h2>
<p>Introduce your project, including what it does or lets you do, why you would use it, and its primary goal (and how it achieves it). This should be similar to your README description, though you can go into a little more detail here if you want.</p>
<h2 id="why-do-i-want-it">Why do I want it?</h2>
<p>Help your user know if your project will help them. Useful information can include:</p>
<ul>
<li>
<p><strong>What is it good for?</strong>: What types of problems does your project solve? What are the benefits of using it?</p>
</li>
<li>
<p><strong>What is it not good for?</strong>: For example, point out situations that might intuitively seem suited for your project, but aren&rsquo;t for some reason. Also mention known limitations, scaling issues, or anything else that might let your users know if the project is not for them.</p>
</li>
<li>
<p><strong>What is it <em>not yet</em> good for?</strong>: Highlight any useful features that are coming soon.</p>
</li>
</ul>
<h2 id="where-should-i-go-next">Where should I go next?</h2>
<p>Give your users next steps from the Overview. For example:</p>
<ul>
<li><a href="/docs/getting-started/">Getting Started</a>: Get started with $project</li>
<li><a href="/docs/examples/">Examples</a>: Check out some example code!</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5f51c0d9befcc514c3187890e479c40f">2 - Getting Started (Java)</h1>
    <div class="lead">What does your user need to know to try your project?</div>
	<p>This is a short guide for getting started with Apache Avro™ using Java. This guide only covers using Avro for data serialization; see Patrick Hunt&rsquo;s <a href="https://github.com/phunt/avro-rpc-quickstart">Avro RPC Quick Start</a> for a good introduction to using Avro for RPC.</p>
<h2 id="download">Download</h2>
<p>Avro implementations for C, C++, C#, Java, PHP, Python, and Ruby can be downloaded from the <a href="https://avro.apache.org/releases.html">Apache Avro™ Releases</a> page. This guide uses Avro 1.10.2, the latest version at the time of writing. For the examples in this guide, download avro-1.10.2.jar and avro-tools-1.10.2.jar.</p>
<p>Alternatively, if you are using Maven, add the following dependency to your POM:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#204a87;font-weight:bold">&lt;dependency&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.apache.avro<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>avro<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;version&gt;</span>1.10.2<span style="color:#204a87;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#204a87;font-weight:bold">&lt;/dependency&gt;</span>
</code></pre></div><p>As well as the Avro Maven plugin (for performing code generation):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#204a87;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.apache.avro<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>avro-maven-plugin<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;version&gt;</span>1.10.2<span style="color:#204a87;font-weight:bold">&lt;/version&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;executions&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;execution&gt;</span>
      <span style="color:#204a87;font-weight:bold">&lt;phase&gt;</span>generate-sources<span style="color:#204a87;font-weight:bold">&lt;/phase&gt;</span>
      <span style="color:#204a87;font-weight:bold">&lt;goals&gt;</span>
        <span style="color:#204a87;font-weight:bold">&lt;goal&gt;</span>schema<span style="color:#204a87;font-weight:bold">&lt;/goal&gt;</span>
      <span style="color:#204a87;font-weight:bold">&lt;/goals&gt;</span>
      <span style="color:#204a87;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#204a87;font-weight:bold">&lt;sourceDirectory&gt;</span>${project.basedir}/src/main/avro/<span style="color:#204a87;font-weight:bold">&lt;/sourceDirectory&gt;</span>
        <span style="color:#204a87;font-weight:bold">&lt;outputDirectory&gt;</span>${project.basedir}/src/main/java/<span style="color:#204a87;font-weight:bold">&lt;/outputDirectory&gt;</span>
      <span style="color:#204a87;font-weight:bold">&lt;/configuration&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;/execution&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/executions&gt;</span>
<span style="color:#204a87;font-weight:bold">&lt;/plugin&gt;</span>
<span style="color:#204a87;font-weight:bold">&lt;plugin&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#204a87;font-weight:bold">&lt;/groupId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;artifactId&gt;</span>maven-compiler-plugin<span style="color:#204a87;font-weight:bold">&lt;/artifactId&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;configuration&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;source&gt;</span>1.8<span style="color:#204a87;font-weight:bold">&lt;/source&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;target&gt;</span>1.8<span style="color:#204a87;font-weight:bold">&lt;/target&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/configuration&gt;</span>
<span style="color:#204a87;font-weight:bold">&lt;/plugin&gt;</span>
</code></pre></div><p>You may also build the required Avro jars from source. Building Avro is beyond the scope of this guide; see the Build Documentation page in the wiki for more information.</p>
<h2 id="defining-a-schema">Defining a schema</h2>
<p>Avro schemas are defined using JSON. Schemas are composed of primitive types (null, boolean, int, long, float, double, bytes, and string) and complex types (record, enum, array, map, union, and fixed). You can learn more about Avro schemas and types from the specification, but for now let&rsquo;s start with a simple schema example, user.avsc:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;namespace&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example.avro&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;User&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">},</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;int&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">]},</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">]}</span>
 <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>This schema defines a record representing a hypothetical user. (Note that a schema file can only contain a single schema definition.) At minimum, a record definition must include its type (&ldquo;type&rdquo;: &ldquo;record&rdquo;), a name (&ldquo;name&rdquo;: &ldquo;User&rdquo;), and fields, in this case name, favorite_number, and favorite_color. We also define a namespace (&ldquo;namespace&rdquo;: &ldquo;example.avro&rdquo;), which together with the name attribute defines the &ldquo;full name&rdquo; of the schema (example.avro.User in this case).</p>
<p>Fields are defined via an array of objects, each of which defines a name and type (other attributes are optional, see the record specification for more details). The type attribute of a field is another schema object, which can be either a primitive or complex type. For example, the name field of our User schema is the primitive type string, whereas the favorite_number and favorite_color fields are both unions, represented by JSON arrays. unions are a complex type that can be any of the types listed in the array; e.g., favorite_number can either be an int or null, essentially making it an optional field.</p>
<h2 id="serializing-and-deserializing-with-code-generation">Serializing and deserializing with code generation</h2>
<h3 id="compiling-the-schema">Compiling the schema</h3>
<p>Code generation allows us to automatically create classes based on our previously-defined schema. Once we have defined the relevant classes, there is no need to use the schema directly in our programs. We use the avro-tools jar to generate code as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">java -jar /path/to/avro-tools-1.10.2.jar compile schema &lt;schema file&gt; &lt;destination&gt;
</code></pre></div><p>This will generate the appropriate source files in a package based on the schema&rsquo;s namespace in the provided destination folder. For instance, to generate a User class in package example.avro from the schema defined above, run</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">java -jar /path/to/avro-tools-1.10.2.jar compile schema user.avsc .
</code></pre></div><p>Note that if you using the Avro Maven plugin, there is no need to manually invoke the schema compiler; the plugin automatically performs code generation on any .avsc files present in the configured source directory.</p>
<h3 id="creating-users">Creating Users</h3>
<p>Now that we&rsquo;ve completed the code generation, let&rsquo;s create some Users, serialize them to a data file on disk, and then read back the file and deserialize the User objects.</p>
<p>First let&rsquo;s create some Users and set their fields.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000">User</span> <span style="color:#000">user1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">();</span>
<span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Alyssa&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setFavoriteNumber</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">256</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#8f5902;font-style:italic">// Leave favorite color null
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#8f5902;font-style:italic">// Alternate constructor
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">User</span> <span style="color:#000">user2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Ben&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">7</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">// Construct via builder
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">User</span> <span style="color:#000">user3</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
             <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Charlie&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
             <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setFavoriteColor</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;blue&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
             <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setFavoriteNumber</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">)</span>
             <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>
</code></pre></div><p>As shown in this example, Avro objects can be created either by invoking a constructor directly or by using a builder. Unlike constructors, builders will automatically set any default values specified in the schema. Additionally, builders validate the data as it set, whereas objects constructed directly will not cause an error until the object is serialized. However, using constructors directly generally offers better performance, as builders create a copy of the datastructure before it is written.</p>
<p>Note that we do not set user1&rsquo;s favorite color. Since that record is of type [&ldquo;string&rdquo;, &ldquo;null&rdquo;], we can either set it to a string or leave it null; it is essentially optional. Similarly, we set user3&rsquo;s favorite number to null (using a builder requires setting all fields, even if they are null).</p>
<h3 id="serializing">Serializing</h3>
<p>Now let&rsquo;s serialize our Users to disk.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8f5902;font-style:italic">// Serialize user1, user2 and user3 to disk
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">DatumWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">userDatumWriter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SpecificDatumWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">DataFileWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">dataFileWriter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataFileWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">userDatumWriter</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getSchema</span><span style="color:#ce5c00;font-weight:bold">(),</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">File</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">append</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">append</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user2</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">append</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user3</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</code></pre></div><p>We create a DatumWriter, which converts Java objects into an in-memory serialized format. The SpecificDatumWriter class is used with generated classes and extracts the schema from the specified generated type.</p>
<p>Next we create a DataFileWriter, which writes the serialized records, as well as the schema, to the file specified in the dataFileWriter.create call. We write our users to the file via calls to the dataFileWriter.append method. When we are done writing, we close the data file.</p>
<h3 id="deserializing">Deserializing</h3>
<p>Finally, let&rsquo;s deserialize the data file we just created.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8f5902;font-style:italic">// Deserialize Users from disk
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">DatumReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">userDatumReader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SpecificDatumReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">DataFileReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">dataFileReader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataFileReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">User</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">file</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">userDatumReader</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">User</span> <span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">dataFileReader</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
<span style="color:#8f5902;font-style:italic">// Reuse user object by passing it to next(). This saves us from
</span><span style="color:#8f5902;font-style:italic">// allocating and garbage collecting many objects for files with
</span><span style="color:#8f5902;font-style:italic">// many items.
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataFileReader</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p>This snippet will output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Alyssa&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">256</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Ben&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Charlie&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;blue&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Deserializing is very similar to serializing. We create a SpecificDatumReader, analogous to the SpecificDatumWriter we used in serialization, which converts in-memory serialized items into instances of our generated class, in this case User. We pass the DatumReader and the previously created File to a DataFileReader, analogous to the DataFileWriter, which reads both the schema used by the writer as well as the data from the file on disk. The data will be read using the writer&rsquo;s schema included in the file and the schema provided by the reader, in this case the User class. The writer&rsquo;s schema is needed to know the order in which fields were written, while the reader&rsquo;s schema is needed to know what fields are expected and how to fill in default values for fields added since the file was written. If there are differences between the two schemas, they are resolved according to the Schema Resolution specification.</p>
<p>Next we use the DataFileReader to iterate through the serialized Users and print the deserialized object to stdout. Note how we perform the iteration: we create a single User object which we store the current deserialized user in, and pass this record object to every call of dataFileReader.next. This is a performance optimization that allows the DataFileReader to reuse the same User object rather than allocating a new User for every iteration, which can be very expensive in terms of object allocation and garbage collection if we deserialize a large data file. While this technique is the standard way to iterate through a data file, it&rsquo;s also possible to use for (User user : dataFileReader) if performance is not a concern.</p>
<h3 id="compiling-and-running-the-example-code">Compiling and running the example code</h3>
<p>This example code is included as a Maven project in the examples/java-example directory in the Avro docs. From this directory, execute the following commands to build and run the example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mvn compile <span style="color:#8f5902;font-style:italic"># includes code generation via Avro Maven plugin</span>
$ mvn -q exec:java -Dexec.mainClass<span style="color:#ce5c00;font-weight:bold">=</span>example.SpecificMain
</code></pre></div><h3 id="beta-feature-generating-faster-code">Beta feature: Generating faster code</h3>
<p>In 1.10.2 release we have introduced a new approach to generating code that speeds up decoding of objects by more than 10% and encoding by more than 30% (future performance enhancements are underway). To ensure a smooth introduction of this change into production systems, this feature is controlled by a feature flag, the system property org.apache.avro.specific.use_custom_coders. In this first release, this feature is off by default. To turn it on, set the system flag to true at runtime. In the sample above, for example, you could enable the fater coders as follows:</p>
<p>$ mvn -q exec:java -Dexec.mainClass=example.SpecificMain<br>
-Dorg.apache.avro.specific.use_custom_coders=true</p>
<p>Note that you do not have to recompile your Avro schema to have access to this feature. The feature is compiled and built into your code, and you turn it on and off at runtime using the feature flag. As a result, you can turn it on during testing, for example, and then off in production. Or you can turn it on in production, and quickly turn it off if something breaks.</p>
<p>We encourage the Avro community to exercise this new feature early to help build confidence. (For those paying one-demand for compute resources in the cloud, it can lead to meaningful cost savings.) As confidence builds, we will turn this feature on by default, and eventually eliminate the feature flag (and the old code).</p>
<h2 id="serializing-and-deserializing-without-code-generation">Serializing and deserializing without code generation</h2>
<p>Data in Avro is always stored with its corresponding schema, meaning we can always read a serialized item regardless of whether we know the schema ahead of time. This allows us to perform serialization and deserialization without code generation.</p>
<p>Let&rsquo;s go over the same example as in the previous section, but without using code generation: we&rsquo;ll create some users, serialize them to a data file on disk, and then read back the file and deserialize the users objects.</p>
<h3 id="creating-users-1">Creating users</h3>
<p>First, we use a Parser to read our schema definition and create a Schema object.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000">Schema</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Schema</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Parser</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">parse</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">File</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user.avsc&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</code></pre></div><p>Using this schema, let&rsquo;s create some users.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000">GenericRecord</span> <span style="color:#000">user1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">GenericData</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Record</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Alyssa&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">256</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#8f5902;font-style:italic">// Leave favorite color null
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">GenericRecord</span> <span style="color:#000">user2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">GenericData</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Record</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Ben&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">7</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">user2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">put</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;favorite_color&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</code></pre></div><p>Since we&rsquo;re not using code generation, we use GenericRecords to represent users. GenericRecord uses the schema to verify that we only specify valid fields. If we try to set a non-existent field (e.g., user1.put(&ldquo;favorite_animal&rdquo;, &ldquo;cat&rdquo;)), we&rsquo;ll get an AvroRuntimeException when we run the program.</p>
<p>Note that we do not set user1&rsquo;s favorite color. Since that record is of type [&ldquo;string&rdquo;, &ldquo;null&rdquo;], we can either set it to a string or leave it null; it is essentially optional.</p>
<h3 id="serializing-1">Serializing</h3>
<p>Now that we&rsquo;ve created our user objects, serializing and deserializing them is almost identical to the example above which uses code generation. The main difference is that we use generic instead of specific readers and writers.</p>
<p>First we&rsquo;ll serialize our users to a data file on disk.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8f5902;font-style:italic">// Serialize user1 and user2 to disk
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">File</span> <span style="color:#000">file</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">File</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">DatumWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">datumWriter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">GenericDatumWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">DataFileWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">dataFileWriter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataFileWriter</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">datumWriter</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">create</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">file</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">append</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user1</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">append</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user2</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">dataFileWriter</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">close</span><span style="color:#ce5c00;font-weight:bold">();</span>
</code></pre></div><p>We create a DatumWriter, which converts Java objects into an in-memory serialized format. Since we are not using code generation, we create a GenericDatumWriter. It requires the schema both to determine how to write the GenericRecords and to verify that all non-nullable fields are present.</p>
<p>As in the code generation example, we also create a DataFileWriter, which writes the serialized records, as well as the schema, to the file specified in the dataFileWriter.create call. We write our users to the file via calls to the dataFileWriter.append method. When we are done writing, we close the data file.</p>
<h3 id="deserializing-1">Deserializing</h3>
<p>Finally, we&rsquo;ll deserialize the data file we just created.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8f5902;font-style:italic">// Deserialize users from disk
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">DatumReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">datumReader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">GenericDatumReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">DataFileReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">dataFileReader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataFileReader</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">GenericRecord</span><span style="color:#ce5c00;font-weight:bold">&gt;(</span><span style="color:#000">file</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">datumReader</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">GenericRecord</span> <span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">dataFileReader</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">hasNext</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
<span style="color:#8f5902;font-style:italic">// Reuse user object by passing it to next(). This saves us from
</span><span style="color:#8f5902;font-style:italic">// allocating and garbage collecting many objects for files with
</span><span style="color:#8f5902;font-style:italic">// many items.
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dataFileReader</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">next</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
<span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user</span><span style="color:#ce5c00;font-weight:bold">);</span>
</code></pre></div><p>This outputs:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Alyssa&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">256</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Ben&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Deserializing is very similar to serializing. We create a GenericDatumReader, analogous to the GenericDatumWriter we used in serialization, which converts in-memory serialized items into GenericRecords. We pass the DatumReader and the previously created File to a DataFileReader, analogous to the DataFileWriter, which reads both the schema used by the writer as well as the data from the file on disk. The data will be read using the writer&rsquo;s schema included in the file, and the reader&rsquo;s schema provided to the GenericDatumReader. The writer&rsquo;s schema is needed to know the order in which fields were written, while the reader&rsquo;s schema is needed to know what fields are expected and how to fill in default values for fields added since the file was written. If there are differences between the two schemas, they are resolved according to the Schema Resolution specification.</p>
<p>Next, we use the DataFileReader to iterate through the serialized users and print the deserialized object to stdout. Note how we perform the iteration: we create a single GenericRecord object which we store the current deserialized user in, and pass this record object to every call of dataFileReader.next. This is a performance optimization that allows the DataFileReader to reuse the same record object rather than allocating a new GenericRecord for every iteration, which can be very expensive in terms of object allocation and garbage collection if we deserialize a large data file. While this technique is the standard way to iterate through a data file, it&rsquo;s also possible to use for (GenericRecord user : dataFileReader) if performance is not a concern.</p>
<h3 id="compiling-and-running-the-example-code-1">Compiling and running the example code</h3>
<p>This example code is included as a Maven project in the examples/java-example directory in the Avro docs. From this directory, execute the following commands to build and run the example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mvn compile
$ mvn -q exec:java -Dexec.mainClass<span style="color:#ce5c00;font-weight:bold">=</span>example.GenericMain
</code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2866df17a036e782ff79002b5a739d03">3 - Getting Started (Python)</h1>
    <div class="lead">What does your user need to know to try your project?</div>
	<p>This is a short guide for getting started with Apache Avro™ using Python. This guide only covers using Avro for data serialization; see Patrick Hunt&rsquo;s Avro RPC Quick Start for a good introduction to using Avro for RPC.</p>
<h2 id="notice-for-python-3-users">Notice for Python 3 users</h2>
<p>A package called &ldquo;avro-python3&rdquo; had been provided to support Python 3 previously, but the codebase was consolidated into the &ldquo;avro&rdquo; package and that supports both Python 2 and 3 now. The avro-python3 package will be removed in the near future, so users should use the &ldquo;avro&rdquo; package instead. They are mostly API compatible, but there&rsquo;s a few minor difference (e.g., function name capitalization, such as avro.schema.Parse vs avro.schema.parse).</p>
<h2 id="download">Download</h2>
<p>For Python, the easiest way to get started is to install it from PyPI. Python&rsquo;s Avro API is available over PyPi.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ python3 -m pip install avro
</code></pre></div><p>The official releases of the Avro implementations for C, C++, C#, Java, PHP, Python, and Ruby can be downloaded from the Apache Avro™ Releases page. This guide uses Avro 1.10.2, the latest version at the time of writing. Download and unzip avro-1.10.2.tar.gz, and install via python setup.py (this will probably require root privileges). Ensure that you can import avro from a Python prompt.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tar xvf avro-1.10.2.tar.gz
$ <span style="color:#204a87">cd</span> avro-1.10.2
$ python setup.py install
$ python
&gt;&gt;&gt; import avro <span style="color:#8f5902;font-style:italic"># should not raise ImportError</span>
</code></pre></div><p>Alternatively, you may build the Avro Python library from source. From your the root Avro directory, run the commands</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#204a87">cd</span> lang/py/
$ python3 -m pip install -e .
$ python
</code></pre></div><h2 id="defining-a-schema">Defining a schema</h2>
<p>Avro schemas are defined using JSON. Schemas are composed of primitive types (null, boolean, int, long, float, double, bytes, and string) and complex types (record, enum, array, map, union, and fixed). You can learn more about Avro schemas and types from the specification, but for now let&rsquo;s start with a simple schema example, user.avsc:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;namespace&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example.avro&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;User&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">},</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;int&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">]},</span>
     <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">]}</span>
 <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>This schema defines a record representing a hypothetical user. (Note that a schema file can only contain a single schema definition.) At minimum, a record definition must include its type (&ldquo;type&rdquo;: &ldquo;record&rdquo;), a name (&ldquo;name&rdquo;: &ldquo;User&rdquo;), and fields, in this case name, favorite_number, and favorite_color. We also define a namespace (&ldquo;namespace&rdquo;: &ldquo;example.avro&rdquo;), which together with the name attribute defines the &ldquo;full name&rdquo; of the schema (example.avro.User in this case).</p>
<p>Fields are defined via an array of objects, each of which defines a name and type (other attributes are optional, see the record specification for more details). The type attribute of a field is another schema object, which can be either a primitive or complex type. For example, the name field of our User schema is the primitive type string, whereas the favorite_number and favorite_color fields are both unions, represented by JSON arrays. unions are a complex type that can be any of the types listed in the array; e.g., favorite_number can either be an int or null, essentially making it an optional field.</p>
<h2 id="serializing-and-deserializing-without-code-generation">Serializing and deserializing without code generation</h2>
<p>Data in Avro is always stored with its corresponding schema, meaning we can always read a serialized item, regardless of whether we know the schema ahead of time. This allows us to perform serialization and deserialization without code generation. Note that the Avro Python library does not support code generation.</p>
<p>Try running the following code snippet, which serializes two users to a data file on disk, and then reads back and deserializes the data file:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">avro.schema</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">avro.datafile</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">DataFileReader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataFileWriter</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">avro.io</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">DatumReader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DatumWriter</span>

<span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user.avsc&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;rb&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">read</span><span style="color:#000;font-weight:bold">())</span>

<span style="color:#000">writer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataFileWriter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;wb&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">DatumWriter</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">schema</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">writer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">({</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Alyssa&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">256</span><span style="color:#000;font-weight:bold">})</span>
<span style="color:#000">writer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">({</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Ben&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;favorite_number&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;favorite_color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#000;font-weight:bold">})</span>
<span style="color:#000">writer</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">close</span><span style="color:#000;font-weight:bold">()</span>

<span style="color:#000">reader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataFileReader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;rb&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">DatumReader</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">user</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">reader</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">print</span> <span style="color:#000">user</span>
<span style="color:#000">reader</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">close</span><span style="color:#000;font-weight:bold">()</span>
</code></pre></div><p>This outputs:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#a40000">u&#39;favorite_color&#39;:</span> <span style="color:#a40000">None,</span> <span style="color:#a40000">u&#39;favorite_number&#39;:</span> <span style="color:#a40000">256,</span> <span style="color:#a40000">u&#39;name&#39;:</span> <span style="color:#a40000">u&#39;Alyssa&#39;</span><span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">{</span><span style="color:#a40000">u&#39;favorite_color&#39;:</span> <span style="color:#a40000">u&#39;red&#39;,</span> <span style="color:#a40000">u&#39;favorite_number&#39;:</span> <span style="color:#a40000">7,</span> <span style="color:#a40000">u&#39;name&#39;:</span> <span style="color:#a40000">u&#39;Ben&#39;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Do make sure that you open your files in binary mode (i.e. using the modes wb or rb respectively). Otherwise you might generate corrupt files due to automatic replacement of newline characters with the platform-specific representations.</p>
<p>Let&rsquo;s take a closer look at what&rsquo;s going on here.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">schema</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user.avsc&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;rb&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">read</span><span style="color:#000;font-weight:bold">())</span>
</code></pre></div><p>avro.schema.parse takes a string containing a JSON schema definition as input and outputs a avro.schema.Schema object (specifically a subclass of Schema, in this case RecordSchema). We&rsquo;re passing in the contents of our user.avsc schema file here.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">writer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataFileWriter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;wb&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">DatumWriter</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">schema</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>We create a DataFileWriter, which we&rsquo;ll use to write serialized items to a data file on disk. The DataFileWriter constructor takes three arguments:</p>
<ul>
<li>The file we&rsquo;ll serialize to</li>
<li>A DatumWriter, which is responsible for actually serializing the items to Avro&rsquo;s binary format (DatumWriters can be used separately from DataFileWriters, e.g., to perform IPC with Avro).</li>
<li>The schema we&rsquo;re using. The DataFileWriter needs the schema both to write the schema to the data file, and to verify that the items we write are valid items and write the appropriate fields.
writer.append({&ldquo;name&rdquo;: &ldquo;Alyssa&rdquo;, &ldquo;favorite_number&rdquo;: 256})
writer.append({&ldquo;name&rdquo;: &ldquo;Ben&rdquo;, &ldquo;favorite_number&rdquo;: 7, &ldquo;favorite_color&rdquo;: &ldquo;red&rdquo;})</li>
</ul>
<p>We use DataFileWriter.append to add items to our data file. Avro records are represented as Python dicts. Since the field favorite_color has type [&ldquo;int&rdquo;, &ldquo;null&rdquo;], we are not required to specify this field, as shown in the first append. Were we to omit the required name field, an exception would be raised. Any extra entries not corresponding to a field are present in the dict are ignored.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">reader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataFileReader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users.avro&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;rb&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">DatumReader</span><span style="color:#000;font-weight:bold">())</span>
</code></pre></div><p>We open the file again, this time for reading back from disk. We use a DataFileReader and DatumReader analagous to the DataFileWriter and DatumWriter above.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">user</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">reader</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#204a87;font-weight:bold">print</span> <span style="color:#000">user</span>
</code></pre></div><p>The DataFileReader is an iterator that returns dicts corresponding to the serialized items.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e21debf31b9dce92de3692d7c2eac94d">4 - Specification</h1>
    
	<h2 id="introduction">Introduction</h2>
<p>This document defines Apache Avro. It is intended to be the authoritative specification. Implementations of Avro must adhere to this document.</p>
<h2 id="schema-declaration">Schema Declaration</h2>
<p>A Schema is represented in <a href="https://www.json.org/">JSON</a> by one of:</p>
<ul>
<li>A JSON string, naming a defined type.</li>
<li>A JSON object, of the form:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;typeName&#34;</span> <span style="color:#a40000">...attributes...</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>where <em>typeName</em> is either a primitive or derived type name, as defined below. Attributes not defined in this document are permitted as metadata, but must not affect the format of serialized data.</p>
<ul>
<li>A JSON array, representing a union of embedded types.</li>
</ul>
<h2 id="primitive-types">Primitive Types</h2>
<p>The set of primitive type names is:</p>
<ul>
<li><em>null</em>: no value</li>
<li><em>boolean</em>: a binary value</li>
<li><em>int</em>: 32-bit signed integer</li>
<li><em>long</em>: 64-bit signed integer</li>
<li><em>float</em>: single precision (32-bit) IEEE 754 floating-point number</li>
<li><em>double</em>: double precision (64-bit) IEEE 754 floating-point number</li>
<li><em>bytes</em>: sequence of 8-bit unsigned bytes</li>
<li><em>string</em>: unicode character sequence
Primitive types have no specified attributes.</li>
</ul>
<p>Primitive type names are also defined type names. Thus, for example, the schema &ldquo;string&rdquo; is equivalent to:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="complex-types">Complex Types</h2>
<p>Avro supports six kinds of complex types: <em>records</em>, <em>enums</em>, <em>arrays</em>, <em>maps</em>, <em>unions</em> and <em>fixed</em>.</p>
<h3 id="records">Records</h3>
<p>Records use the type name &ldquo;record&rdquo; and support three attributes:</p>
<ul>
<li><em>name</em>: a JSON string providing the name of the record (required).</li>
<li><em>namespace</em>, a JSON string that qualifies the name;</li>
<li><em>doc</em>: a JSON string providing documentation to the user of this schema (optional).</li>
<li><em>aliases</em>: a JSON array of strings, providing alternate names for this record (optional).</li>
<li><em>fields</em>: a JSON array, listing fields (required). Each field is a JSON object with the following attributes:
<ul>
<li>
<p><em>name</em>: a JSON string providing the name of the field (required), and</p>
</li>
<li>
<p><em>doc</em>: a JSON string describing this field for users (optional).</p>
</li>
<li>
<p><em>type</em>: a schema, as defined above</p>
</li>
<li>
<p><em>default</em>: A default value for this field, only used when reading instances that lack the field for schema evolution purposes. The presence of a default value does not make the field optional at encoding time. Permitted values depend on the field&rsquo;s schema type, according to the table below. Default values for union fields correspond to the first schema in the union. Default values for bytes and fixed fields are JSON strings, where Unicode code points 0-255 are mapped to unsigned 8-bit byte values 0-255. Avro encodes a field even if its value is equal to its default.</p>
<h2 id="field-default-values"><em>field default values</em></h2>
<table>
<thead>
<tr>
<th><strong>avro type</strong></th>
<th><strong>json type</strong></th>
<th style="text-align:right"><strong>example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>null</td>
<td>null</td>
<td style="text-align:right">null</td>
</tr>
<tr>
<td>boolean</td>
<td>boolean</td>
<td style="text-align:right">true</td>
</tr>
<tr>
<td>int,long</td>
<td>integer</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td>float,double</td>
<td>number</td>
<td style="text-align:right">1.1</td>
</tr>
<tr>
<td>bytes</td>
<td>string</td>
<td style="text-align:right">&ldquo;\u00FF&rdquo;</td>
</tr>
<tr>
<td>string</td>
<td>string</td>
<td style="text-align:right">&ldquo;foo&rdquo;</td>
</tr>
<tr>
<td>record</td>
<td>object</td>
<td style="text-align:right">{&ldquo;a&rdquo;: 1}</td>
</tr>
<tr>
<td>enum</td>
<td>string</td>
<td style="text-align:right">&ldquo;FOO&rdquo;</td>
</tr>
<tr>
<td>array</td>
<td>array</td>
<td style="text-align:right">[1]</td>
</tr>
<tr>
<td>map</td>
<td>object</td>
<td style="text-align:right">{&ldquo;a&rdquo;: 1}</td>
</tr>
<tr>
<td>fixed</td>
<td>string</td>
<td style="text-align:right">&ldquo;\u00ff&rdquo;</td>
</tr>
</tbody>
</table>
<hr>
</li>
<li>
<p>order: specifies how this field impacts sort ordering of this record (optional). Valid values are &ldquo;ascending&rdquo; (the default), &ldquo;descending&rdquo;, or &ldquo;ignore&rdquo;. For more details on how this is used, see the sort order section below.</p>
</li>
<li>
<p>aliases: a JSON array of strings, providing alternate names for this field (optional).</p>
</li>
</ul>
</li>
</ul>
<p>For example, a linked-list of 64-bit values may be defined with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LongList&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;aliases&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;LinkedLongs&#34;</span><span style="color:#000;font-weight:bold">],</span>                      <span style="color:#a40000">//</span> <span style="color:#a40000">old</span> <span style="color:#a40000">name</span> <span style="color:#a40000">for</span> <span style="color:#a40000">this</span>
  <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">},</span>             <span style="color:#a40000">//</span> <span style="color:#a40000">each</span> <span style="color:#a40000">element</span> <span style="color:#a40000">has</span> <span style="color:#a40000">a</span> <span style="color:#a40000">long</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;next&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;LongList&#34;</span><span style="color:#000;font-weight:bold">]}</span> <span style="color:#a40000">//</span> <span style="color:#a40000">optional</span> <span style="color:#a40000">next</span> <span style="color:#a40000">element</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="enums">Enums</h3>
<p>Enums use the type name &ldquo;enum&rdquo; and support the following attributes:</p>
<ul>
<li><em>name</em>: a JSON string providing the name of the enum (required).</li>
<li><em>namespace</em>, a JSON string that qualifies the name;</li>
<li><em>aliases</em>: a JSON array of strings, providing alternate names for this enum (optional).</li>
<li><em>doc</em>: a JSON string providing documentation to the user of this schema (optional).</li>
<li><em>symbols</em>: a JSON array, listing symbols, as JSON strings (required). All symbols in an enum must be unique; duplicates are prohibited. Every symbol must match the regular expression [A-Za-z_][A-Za-z0-9_]* (the same requirement as for names).</li>
<li><em>default</em>: A default value for this enumeration, used during resolution when the reader encounters a symbol from the writer that isn&rsquo;t defined in the reader&rsquo;s schema (optional). The value provided here must be a JSON string that&rsquo;s a member of the symbols array. See documentation on schema resolution for how this gets used.</li>
</ul>
<p>For example, playing card suits might be defined with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Suit&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;symbols&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;SPADES&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;HEARTS&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;DIAMONDS&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;CLUBS&#34;</span><span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="arrays">Arrays</h3>
<p>Arrays use the type name &ldquo;array&rdquo; and support a single attribute:</p>
<ul>
<li><em>items</em>: the schema of the array&rsquo;s items.</li>
</ul>
<p>For example, an array of strings is declared with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;array&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;items&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="maps">Maps</h3>
<p>Maps use the type name &ldquo;map&rdquo; and support one attribute:</p>
<ul>
<li><em>values</em>: the schema of the map&rsquo;s values.</li>
</ul>
<p>Map keys are assumed to be strings.</p>
<p>For example, a map from string to long is declared with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;values&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="unions">Unions</h3>
<p>Unions, as mentioned above, are represented using JSON arrays. For example, [&ldquo;null&rdquo;, &ldquo;string&rdquo;] declares a schema which may be either a null or string.</p>
<p>(Note that when a default value is specified for a record field whose type is a union, the type of the default value must match the first element of the union. Thus, for unions containing &ldquo;null&rdquo;, the &ldquo;null&rdquo; is usually listed first, since the default value of such unions is typically null.)</p>
<p>Unions may not contain more than one schema with the same type, except for the named types record, fixed and enum. For example, unions containing two array types or two map types are not permitted, but two types with different names are permitted. (Names permit efficient resolution when reading and writing unions.)</p>
<p>Unions may not immediately contain other unions.</p>
<h3 id="fixed">Fixed</h3>
<p>Fixed uses the type name &ldquo;fixed&rdquo; and supports two attributes:</p>
<ul>
<li><em>name</em>: a string naming this fixed (required).</li>
<li><em>namespace</em>, a string that qualifies the name;</li>
<li><em>aliases</em>: a JSON array of strings, providing alternate names for this enum (optional).</li>
<li><em>size</em>: an integer, specifying the number of bytes per value (required).</li>
</ul>
<p>For example, 16-byte quantity may be declared with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;md5&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="names">Names</h3>
<p>Record, enums and fixed are named types. Each has a fullname that is composed of two parts; a name and a namespace. Equality of names is defined on the fullname.</p>
<p>The name portion of a fullname, record field names, and enum symbols must:</p>
<ul>
<li>start with [A-Za-z_]</li>
<li>subsequently contain only [A-Za-z0-9_]</li>
</ul>
<p>A namespace is a dot-separated sequence of such names. The empty string may also be used as a namespace to indicate the null namespace. Equality of names (including field names and enum symbols) as well as fullnames is case-sensitive.</p>
<p>The null namespace may not be used in a dot-separated sequence of names. So the grammar for a namespace is:</p>
<pre><code>  &lt;empty&gt; | &lt;name&gt;[(&lt;dot&gt;&lt;name&gt;)*]
</code></pre><p>In record, enum and fixed definitions, the fullname is determined in one of the following ways:</p>
<ul>
<li>A name and namespace are both specified. For example, one might use &ldquo;name&rdquo;: &ldquo;X&rdquo;, &ldquo;namespace&rdquo;: &ldquo;org.foo&rdquo; to indicate the fullname org.foo.X.</li>
<li>A fullname is specified. If the name specified contains a dot, then it is assumed to be a fullname, and any namespace also specified is ignored. For example, use &ldquo;name&rdquo;: &ldquo;org.foo.X&rdquo; to indicate the fullname org.foo.X.</li>
<li>A name only is specified, i.e., a name that contains no dots. In this case the namespace is taken from the most tightly enclosing schema or protocol. For example, if &ldquo;name&rdquo;: &ldquo;X&rdquo; is specified, and this occurs within a field of the record definition of org.foo.Y, then the fullname is org.foo.X. If there is no enclosing namespace then the null namespace is used.</li>
</ul>
<p>References to previously defined names are as in the latter two cases above: if they contain a dot they are a fullname, if they do not contain a dot, the namespace is the namespace of the enclosing definition.</p>
<p>Primitive type names have no namespace and their names may not be defined in any namespace.</p>
<p>A schema or protocol may not contain multiple definitions of a fullname. Further, a name must be defined before it is used (&ldquo;before&rdquo; in the depth-first, left-to-right traversal of the JSON parse tree, where the types attribute of a protocol is always deemed to come &ldquo;before&rdquo; the messages attribute.)</p>
<h3 id="aliases">Aliases</h3>
<p>Named types and fields may have aliases. An implementation may optionally use aliases to map a writer&rsquo;s schema to the reader&rsquo;s. This faciliates both schema evolution as well as processing disparate datasets.</p>
<p>Aliases function by re-writing the writer&rsquo;s schema using aliases from the reader&rsquo;s schema. For example, if the writer&rsquo;s schema was named &ldquo;Foo&rdquo; and the reader&rsquo;s schema is named &ldquo;Bar&rdquo; and has an alias of &ldquo;Foo&rdquo;, then the implementation would act as though &ldquo;Foo&rdquo; were named &ldquo;Bar&rdquo; when reading. Similarly, if data was written as a record with a field named &ldquo;x&rdquo; and is read as a record with a field named &ldquo;y&rdquo; with alias &ldquo;x&rdquo;, then the implementation would act as though &ldquo;x&rdquo; were named &ldquo;y&rdquo; when reading.</p>
<p>A type alias may be specified either as a fully namespace-qualified, or relative to the namespace of the name it is an alias for. For example, if a type named &ldquo;a.b&rdquo; has aliases of &ldquo;c&rdquo; and &ldquo;x.y&rdquo;, then the fully qualified names of its aliases are &ldquo;a.c&rdquo; and &ldquo;x.y&rdquo;.</p>
<h2 id="data-serialization-and-deserialization">Data Serialization and Deserialization</h2>
<p>Binary encoded Avro data does not include type information or field names. The benefit is that the serialized data is small, but as a result a schema must always be used in order to read Avro data correctly. The best way to ensure that the schema is structurally identical to the one used to write the data is to use the exact same schema.</p>
<p>Therefore, files or systems that store Avro data should always include the writer&rsquo;s schema for that data. Avro-based remote procedure call (RPC) systems must also guarantee that remote recipients of data have a copy of the schema used to write that data. In general, it is advisable that any reader of Avro data should use a schema that is the same (as defined more fully in Parsing Canonical Form for Schemas) as the schema that was used to write the data in order to deserialize it correctly. Deserializing data into a newer schema is accomplished by specifying an additional schema, the results of which are described in Schema Resolution.</p>
<p>In general, both serialization and deserialization proceed as a depth-first, left-to-right traversal of the schema, serializing or deserializing primitive types as they are encountered. Therefore, it is possible, though not advisable, to read Avro data with a schema that does not have the same Parsing Canonical Form as the schema with which the data was written. In order for this to work, the serialized primitive values must be compatible, in order value by value, with the items in the deserialization schema. For example, int and long are always serialized the same way, so an int could be deserialized as a long. Since the compatibility of two schemas depends on both the data and the serialization format (eg. binary is more permissive than JSON because JSON includes field names, eg. a long that is too large will overflow an int), it is simpler and more reliable to use schemas with identical Parsing Canonical Form.</p>
<h3 id="encodings">Encodings</h3>
<p>Avro specifies two serialization encodings: binary and JSON. Most applications will use the binary encoding, as it is smaller and faster. But, for debugging and web-based applications, the JSON encoding may sometimes be appropriate.</p>
<h3 id="binary-encoding">Binary Encoding</h3>
<p>Binary encoding does not include field names, self-contained information about the types of individual bytes, nor field or record separators. Therefore readers are wholly reliant on the schema used when the data was encoded.</p>
<h4 id="primitive-types-1">Primitive Types</h4>
<p>Primitive types are encoded in binary as follows:</p>
<ul>
<li><em>null</em> is written as zero bytes.</li>
<li>a <em>boolean</em> is written as a single byte whose value is either 0 (false) or 1 (true).</li>
<li><em>int</em> and <em>long</em> values are written using variable-length zig-zag coding. Some examples:</li>
</ul>
<hr>
<table>
<thead>
<tr>
<th><em>value</em></th>
<th><em>hex</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>00</td>
</tr>
<tr>
<td>-1</td>
<td>01</td>
</tr>
<tr>
<td>1</td>
<td>02</td>
</tr>
<tr>
<td>-2</td>
<td>03</td>
</tr>
<tr>
<td>2</td>
<td>04</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>-64</td>
<td>7f</td>
</tr>
<tr>
<td>64</td>
<td>80 01</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
</tbody>
</table>
<hr>
<ul>
<li>a <em>float</em> is written as 4 bytes. The float is converted into a 32-bit integer using a method equivalent to Java&rsquo;s <a href="https://docs.oracle.com/javase/6/docs/api/java/lang/Float.html#floatToIntBits%28float%29">floatToIntBits</a> and then encoded in little-endian format.</li>
<li>a <em>double</em> is written as 8 bytes. The double is converted into a 64-bit integer using a method equivalent to Java&rsquo;s <a href="https://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#doubleToLongBits%28double%29">doubleToLongBits</a> and then encoded in little-endian format.</li>
<li><em>bytes</em> are encoded as a long followed by that many bytes of data.</li>
<li>a <em>string</em> is encoded as a long followed by that many bytes of UTF-8 encoded character data.
For example, the three-character string &ldquo;foo&rdquo; would be encoded as the long value 3 (encoded as hex 06) followed by the UTF-8 encoding of &lsquo;f&rsquo;, &lsquo;o&rsquo;, and &lsquo;o&rsquo; (the hex bytes 66 6f 6f):</li>
</ul>
<pre><code>06 66 6f 6f
</code></pre><h3 id="complex-types-1">Complex Types</h3>
<p>Complex types are encoded in binary as follows:</p>
<h4 id="records-1">Records</h4>
<p>A record is encoded by encoding the values of its fields in the order that they are declared. In other words, a record is encoded as just the concatenation of the encodings of its fields. Field values are encoded per their schema.</p>
<p>For example, the record schema</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;test&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;a&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;b&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">}</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>An instance of this record whose a field has value 27 (encoded as hex 36) and whose b field has value &ldquo;foo&rdquo; (encoded as hex bytes 06 66 6f 6f), would be encoded simply as the concatenation of these, namely the hex byte sequence:</p>
<pre><code>36 06 66 6f 6f
</code></pre><h4 id="enums-1">Enums</h4>
<p>An enum is encoded by a int, representing the zero-based position of the symbol in the schema.</p>
<p>For example, consider the enum:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Foo&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;symbols&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;A&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;B&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;C&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;D&#34;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>This would be encoded by an int between zero and three, with zero indicating &ldquo;A&rdquo;, and 3 indicating &ldquo;D&rdquo;.</p>
<h4 id="arrays-1">Arrays</h4>
<p>Arrays are encoded as a series of blocks. Each block consists of a long count value, followed by that many array items. A block with count zero indicates the end of the array. Each item is encoded per the array&rsquo;s item schema.</p>
<p>If a block&rsquo;s count is negative, its absolute value is used, and the count is followed immediately by a long block size indicating the number of bytes in the block. This block size permits fast skipping through data, e.g., when projecting a record to a subset of its fields.</p>
<p>For example, the array schema</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;array&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;items&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>an array containing the items 3 and 27 could be encoded as the long value 2 (encoded as hex 04) followed by long values 3 and 27 (encoded as hex 06 36) terminated by zero:</p>
<pre><code>04 06 36 00
</code></pre><p>The blocked representation permits one to read and write arrays larger than can be buffered in memory, since one can start writing items without knowing the full length of the array.</p>
<h4 id="maps-1">Maps</h4>
<p>Maps are encoded as a series of <em>blocks</em>. Each block consists of a <code>long</code> <em>count</em> value, followed by that many key/value pairs. A block with count zero indicates the end of the map. Each item is encoded per the map&rsquo;s value schema.</p>
<p>If a block&rsquo;s count is negative, its absolute value is used, and the count is followed immediately by a <code>long</code> block size indicating the number of bytes in the block. This block size permits fast skipping through data, e.g., when projecting a record to a subset of its fields.</p>
<p>The blocked representation permits one to read and write maps larger than can be buffered in memory, since one can start writing items without knowing the full length of the map.</p>
<h4 id="unions-1">Unions</h4>
<p>A union is encoded by first writing an <code>int</code> value indicating the zero-based position within the union of the schema of its value. The value is then encoded per the indicated schema within the union.</p>
<p>For example, the union schema [&ldquo;null&rdquo;,&ldquo;string&rdquo;] would encode:</p>
<ul>
<li><em>null</em> as zero (the index of &ldquo;null&rdquo; in the union):
<code>00</code></li>
<li>the string &ldquo;a&rdquo; as one (the index of &ldquo;string&rdquo; in the union, encoded as hex 02), followed by the serialized string:
<code>02 02 61</code>
NOTE: Currently for C/C++ implementations, the positions are practically an int, but theoretically a long. In reality, we don&rsquo;t expect unions with 215M members</li>
</ul>
<h4 id="fixed-1">Fixed</h4>
<p>Fixed instances are encoded using the number of bytes declared in the schema.</p>
<h3 id="json-encoding">JSON Encoding</h3>
<p>Except for unions, the JSON encoding is the same as is used to encode field default values.</p>
<p>The value of a union is encoded in JSON as follows:</p>
<ul>
<li>if its type is <em>null</em>, then it is encoded as a JSON <em>null</em>;</li>
<li>otherwise it is encoded as a JSON object with one name/value pair whose name is the type&rsquo;s name and whose value is the recursively encoded value. For Avro&rsquo;s named types (record, fixed or enum) the user-specified name is used, for other types the type name is used.</li>
</ul>
<p>For example, the union schema [&ldquo;null&rdquo;,&ldquo;string&rdquo;,&ldquo;Foo&rdquo;], where Foo is a record name, would encode:</p>
<ul>
<li><em>null</em> as <em>null</em>;</li>
<li>the string &ldquo;a&rdquo; as <code>{&quot;string&quot;: &quot;a&quot;}</code> and</li>
<li>a Foo instance as <code>{&quot;Foo&quot;: {...}}</code>, where <code>{...}</code> indicates the JSON encoding of a Foo instance.</li>
</ul>
<p>Note that the original schema is still required to correctly process JSON-encoded data. For example, the JSON encoding does not distinguish between int and long, float and double, records and maps, enums and strings, etc.</p>
<h4 id="single-object-encoding">Single-object encoding</h4>
<p>In some situations a single Avro serialized object is to be stored for a longer period of time. One very common example is storing Avro records for several weeks in an <a href="https://kafka.apache.org/">Apache Kafka</a> topic.</p>
<p>In the period after a schema change this persistence system will contain records that have been written with different schemas. So the need arises to know which schema was used to write a record to support schema evolution correctly. In most cases the schema itself is too large to include in the message, so this binary wrapper format supports the use case more effectively.</p>
<h5 id="single-object-encoding-specification">Single object encoding specification</h5>
<p>Single Avro objects are encoded as follows:</p>
<ul>
<li>A two-byte marker, <code>C3 01</code>, to show that the message is Avro and uses this single-record format (version 1).</li>
<li>The 8-byte little-endian CRC-64-AVRO <a href="#schema_fingerprints">fingerprint</a> of the object&rsquo;s schema</li>
<li>The Avro object encoded using <a href="#binary_encoding">Avro&rsquo;s binary encoding</a></li>
</ul>
<p>Implementations use the 2-byte marker to determine whether a payload is Avro. This check helps avoid expensive lookups that resolve the schema from a fingerprint, when the message is not an encoded Avro payload.</p>
<h2 id="sort-order">Sort Order</h2>
<p>Avro defines a standard sort order for data. This permits data written by one system to be efficiently sorted by another system. This can be an important optimization, as sort order comparisons are sometimes the most frequent per-object operation. Note also that Avro binary-encoded data can be efficiently ordered without deserializing it to objects.</p>
<p>Data items may only be compared if they have identical schemas. Pairwise comparisons are implemented recursively with a depth-first, left-to-right traversal of the schema. The first mismatch encountered determines the order of the items.</p>
<p>Two items with the same schema are compared according to the following rules.</p>
<ul>
<li><em>null</em> data is always equal.</li>
<li><em>boolean</em> data is ordered with false before true.</li>
<li><em>int</em>, <em>long</em>, <em>float</em> and <em>double</em> data is ordered by ascending numeric value.</li>
<li><em>bytes</em> and fixed data are compared lexicographically by unsigned 8-bit values.</li>
<li><em>string</em> data is compared lexicographically by Unicode code point. Note that since UTF-8 is used as the binary encoding for strings, sorting of bytes and string binary data is identical.</li>
<li><em>array</em> data is compared lexicographically by element.</li>
<li><em>enum</em> data is ordered by the symbol&rsquo;s position in the enum schema. For example, an enum whose symbols are [&ldquo;z&rdquo;, &ldquo;a&rdquo;] would sort &ldquo;z&rdquo; values before &ldquo;a&rdquo; values.</li>
<li><em>union</em> data is first ordered by the branch within the union, and, within that, by the type of the branch. For example, an [&ldquo;int&rdquo;, &ldquo;string&rdquo;] union would order all int values before all string values, with the ints and strings themselves ordered as defined above.</li>
<li><em>record</em> data is ordered lexicographically by field. If a field specifies that its order is:
<ul>
<li>&ldquo;ascending&rdquo;, then the order of its values is unaltered.</li>
<li>&ldquo;descending&rdquo;, then the order of its values is reversed.</li>
<li>&ldquo;ignore&rdquo;, then its values are ignored when sorting.</li>
</ul>
</li>
<li><em>map</em> data may not be compared. It is an error to attempt to compare data containing maps unless those maps are in an <code>&quot;order&quot;:&quot;ignore&quot;</code> record field.</li>
</ul>
<h2 id="object-container-files">Object Container Files</h2>
<p>Avro includes a simple object container file format. A file has a schema, and all objects stored in the file must be written according to that schema, using binary encoding. Objects are stored in blocks that may be compressed. Syncronization markers are used between blocks to permit efficient splitting of files for MapReduce processing.</p>
<p>Files may include arbitrary user-specified metadata.</p>
<p>A file consists of:</p>
<ul>
<li>A file header, followed by</li>
<li>one or more file data blocks.</li>
</ul>
<p>A file header consists of:</p>
<ul>
<li>Four bytes, ASCII &lsquo;O&rsquo;, &lsquo;b&rsquo;, &lsquo;j&rsquo;, followed by 1.</li>
<li>file metadata, including the schema.</li>
<li>The 16-byte, randomly-generated sync marker for this file.</li>
</ul>
<p>File metadata is written as if defined by the following map schema:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;values&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>All metadata properties that start with &ldquo;avro.&rdquo; are reserved. The following file metadata properties are currently used:</p>
<ul>
<li><strong>avro.schema</strong> contains the schema of objects stored in the file, as JSON data (required).</li>
<li><strong>avro.codec</strong> the name of the compression codec used to compress blocks, as a string. Implementations are required to support the following codecs: &ldquo;null&rdquo; and &ldquo;deflate&rdquo;. If codec is absent, it is assumed to be &ldquo;null&rdquo;. The codecs are described with more detail below.</li>
</ul>
<p>A file header is thus described by the following schema:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;org.apache.avro.file.Header&#34;</span><span style="color:#000;font-weight:bold">,</span>
 <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
   <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;magic&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Magic&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">}},</span>
   <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;values&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">}},</span>
   <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Sync&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16</span><span style="color:#000;font-weight:bold">}},</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>A file data block consists of:</p>
<ul>
<li>A long indicating the count of objects in this block.</li>
<li>A long indicating the size in bytes of the serialized objects in the current block, after any codec is applied</li>
<li>The serialized objects. If a codec is specified, this is compressed by that codec.</li>
<li>The file&rsquo;s 16-byte sync marker.</li>
</ul>
<p>Thus, each block&rsquo;s binary data can be efficiently extracted or skipped without deserializing the contents. The combination of block size, object counts, and sync markers enable detection of corrupt blocks and help ensure data integrity.</p>
<h3 id="required-codecs">Required Codecs</h3>
<p><em>null</em></p>
<p>The &ldquo;null&rdquo; codec simply passes through data uncompressed.</p>
<p><em>deflate</em></p>
<p>The &ldquo;deflate&rdquo; codec writes the data block using the deflate algorithm as specified in <a href="https://www.isi.edu/in-notes/rfc1951.txt">RFC 1951</a>, and typically implemented using the zlib library. Note that this format (unlike the &ldquo;zlib format&rdquo; in RFC 1950) does not have a checksum.</p>
<h3 id="optional-codecs">Optional Codecs</h3>
<p><em>bzip2</em></p>
<p>The &ldquo;bzip2&rdquo; codec uses the <a href="https://sourceware.org/bzip2/">bzip2</a> compression library.</p>
<p><em>snappy</em></p>
<p>The &ldquo;snappy&rdquo; codec uses Google&rsquo;s <a href="https://code.google.com/p/snappy/">Snappy</a> compression library. Each compressed block is followed by the 4-byte, big-endian CRC32 checksum of the uncompressed data in the block.</p>
<p><em>xz</em></p>
<p>The &ldquo;xz&rdquo; codec uses the <a href="https://tukaani.org/xz/">XZ</a> compression library.</p>
<p><em>zstandard</em></p>
<p>The &ldquo;zstandard&rdquo; codec uses Facebook&rsquo;s <a href="https://facebook.github.io/zstd/">Zstandard</a> compression library.</p>
<h3 id="protocol-declaration">Protocol Declaration</h3>
<p>Avro protocols describe RPC interfaces. Like schemas, they are defined with JSON text.</p>
<p>A protocol is a JSON object with the following attributes:</p>
<ul>
<li><em>protocol</em>, a string, the name of the protocol (required);</li>
<li><em>namespace</em>, an optional string that qualifies the name;</li>
<li><em>doc</em>, an optional string describing this protocol;</li>
<li><em>types</em>, an optional list of definitions of named types (records, enums, fixed and errors). An error definition is just like a record definition except it uses &ldquo;error&rdquo; instead of &ldquo;record&rdquo;. Note that forward references to named types are not permitted.</li>
<li><em>messages</em>, an optional JSON object whose keys are message names and whose values are objects whose attributes are described below. No two messages may have the same name.</li>
</ul>
<p>The name and namespace qualification rules defined for schema objects apply to protocols as well.</p>
<h3 id="messages">Messages</h3>
<p>A message has attributes:</p>
<ul>
<li>a <em>doc</em>, an optional description of the message,</li>
<li>a <em>request</em>, a list of named, typed parameter schemas (this has the same form as the fields of a record declaration);</li>
<li>a <em>response</em> schema;</li>
<li>an optional union of declared error schemas. The effective union has &ldquo;string&rdquo; prepended to the declared union, to permit transmission of undeclared &ldquo;system&rdquo; errors. For example, if the declared error union is <code>[&quot;AccessError&quot;]</code>, then the effective union is <code>[&quot;string&quot;, &quot;AccessError&quot;]</code>. When no errors are declared, the effective error union is <code>[&quot;string&quot;]</code>. Errors are serialized using the effective union; however, a protocol&rsquo;s JSON declaration contains only the declared union.</li>
<li>an optional one-way boolean parameter.</li>
</ul>
<p>A request parameter list is processed equivalently to an anonymous record. Since record field lists may vary between reader and writer, request parameters may also differ between the caller and responder, and such differences are resolved in the same manner as record field differences.</p>
<p>The one-way parameter may only be true when the response type is <code>&quot;null&quot;</code> and no errors are listed.</p>
<h3 id="sample-protocol">Sample Protocol</h3>
<p>For example, one may define a simple HelloWorld protocol with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;namespace&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;com.acme&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;protocol&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;HelloWorld&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;doc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Protocol Greetings&#34;</span><span style="color:#000;font-weight:bold">,</span>

  <span style="color:#204a87;font-weight:bold">&#34;types&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Greeting&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
      <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;message&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">}]},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Curse&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;error&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
      <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;message&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">}]}</span>
  <span style="color:#000;font-weight:bold">],</span>

  <span style="color:#204a87;font-weight:bold">&#34;messages&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;hello&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#204a87;font-weight:bold">&#34;doc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Say hello.&#34;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#204a87;font-weight:bold">&#34;request&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;greeting&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Greeting&#34;</span> <span style="color:#000;font-weight:bold">}],</span>
      <span style="color:#204a87;font-weight:bold">&#34;response&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Greeting&#34;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#204a87;font-weight:bold">&#34;errors&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;Curse&#34;</span><span style="color:#000;font-weight:bold">]</span>
    <span style="color:#000;font-weight:bold">}</span>
  <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="protocol-wire-format">Protocol Wire Format</h2>
<h3 id="message-transport">Message Transport</h3>
<p>Messages may be transmitted via different transport mechanisms.</p>
<p>To the transport, a <em>message</em> is an opaque byte sequence.</p>
<p>A transport is a system that supports:</p>
<ul>
<li><strong>transmission of request messages</strong></li>
<li><strong>receipt of corresponding response messages</strong>
Servers may send a response message back to the client corresponding to a request message. The mechanism of correspondance is transport-specific. For example, in HTTP it is implicit, since HTTP directly supports requests and responses. But a transport that multiplexes many client threads over a single socket would need to tag messages with unique identifiers.</li>
</ul>
<p>Transports may be either stateless or stateful. In a stateless transport, messaging assumes no established connection state, while stateful transports establish connections that may be used for multiple messages. This distinction is discussed further in the <a href="#handshake">handshake</a> section below.</p>
<h4 id="http-as-transport">HTTP as Transport</h4>
<p>When <a href="https://www.w3.org/Protocols/rfc2616/rfc2616.html">HTTP</a> is used as a transport, each Avro message exchange is an HTTP request/response pair. All messages of an Avro protocol should share a single URL at an HTTP server. Other protocols may also use that URL. Both normal and error Avro response messages should use the 200 (OK) response code. The chunked encoding may be used for requests and responses, but, regardless the Avro request and response are the entire content of an HTTP request and response. The HTTP Content-Type of requests and responses should be specified as &ldquo;avro/binary&rdquo;. Requests should be made using the POST method.</p>
<p>HTTP is used by Avro as a stateless transport.</p>
<h3 id="message-framing">Message Framing</h3>
<p>Avro messages are <em>framed</em> as a list of buffers.</p>
<p>Framing is a layer between messages and the transport. It exists to optimize certain operations.</p>
<p>The format of framed message data is:</p>
<ul>
<li>a series of buffers, where each buffer consists of:
<ul>
<li>a four-byte, big-endian <em>buffer length</em>, followed by</li>
<li>that many bytes of <em>buffer</em> data.</li>
</ul>
</li>
<li>a message is always terminated by a zero-length buffer.</li>
</ul>
<p>Framing is transparent to request and response message formats (described below). Any message may be presented as a single or multiple buffers.</p>
<p>Framing can permit readers to more efficiently get different buffers from different sources and for writers to more efficiently store different buffers to different destinations. In particular, it can reduce the number of times large binary objects are copied. For example, if an RPC parameter consists of a megabyte of file data, that data can be copied directly to a socket from a file descriptor, and, on the other end, it could be written directly to a file descriptor, never entering user space.</p>
<p>A simple, recommended, framing policy is for writers to create a new segment whenever a single binary object is written that is larger than a normal output buffer. Small objects are then appended in buffers, while larger objects are written as their own buffers. When a reader then tries to read a large object the runtime can hand it an entire buffer directly, without having to copy it.</p>
<h3 id="handshake">Handshake</h3>
<p>The purpose of the handshake is to ensure that the client and the server have each other&rsquo;s protocol definition, so that the client can correctly deserialize responses, and the server can correctly deserialize requests. Both clients and servers should maintain a cache of recently seen protocols, so that, in most cases, a handshake will be completed without extra round-trip network exchanges or the transmission of full protocol text.</p>
<p>RPC requests and responses may not be processed until a handshake has been completed. With a stateless transport, all requests and responses are prefixed by handshakes. With a stateful transport, handshakes are only attached to requests and responses until a successful handshake response has been returned over a connection. After this, request and response payloads are sent without handshakes for the lifetime of that connection.</p>
<p>The handshake process uses the following record schemas:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;HandshakeRequest&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;namespace&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;org.apache.avro.ipc&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;clientHash&#34;</span><span style="color:#000;font-weight:bold">,</span>
     <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;MD5&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16</span><span style="color:#000;font-weight:bold">}},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;clientProtocol&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">]},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverHash&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;MD5&#34;</span><span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;values&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">}]}</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;HandshakeResponse&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;namespace&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;org.apache.avro.ipc&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;match&#34;</span><span style="color:#000;font-weight:bold">,</span>
     <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;HandshakeMatch&#34;</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#204a87;font-weight:bold">&#34;symbols&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;BOTH&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;CLIENT&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NONE&#34;</span><span style="color:#000;font-weight:bold">]}},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverProtocol&#34;</span><span style="color:#000;font-weight:bold">,</span>
     <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">]},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;serverHash&#34;</span><span style="color:#000;font-weight:bold">,</span>
     <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;MD5&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16</span><span style="color:#000;font-weight:bold">}]},</span>
    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span><span style="color:#000;font-weight:bold">,</span>
     <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;values&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">}]}</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>A client first prefixes each request with a <code>HandshakeRequest</code> containing just the hash of its protocol and of the server&rsquo;s protocol (<code>clientHash!=null, clientProtocol=null, serverHash!=null</code>), where the hashes are 128-bit MD5 hashes of the JSON protocol text. If a client has never connected to a given server, it sends its hash as a guess of the server&rsquo;s hash, otherwise it sends the hash that it previously obtained from this server.
The server responds with a HandshakeResponse containing one of:
<ul>
<li><code>match=BOTH, serverProtocol=null, serverHash=null</code> if the client sent the valid hash of the server&rsquo;s protocol and the server knows what protocol corresponds to the client&rsquo;s hash. In this case, the request is complete and the response data immediately follows the HandshakeResponse.</li>
<li><code>match=CLIENT, serverProtocol!=null, serverHash!=null</code> if the server has previously seen the client&rsquo;s protocol, but the client sent an incorrect hash of the server&rsquo;s protocol. The request is complete and the response data immediately follows the HandshakeResponse. The client must use the returned protocol to process the response and should also cache that protocol and its hash for future interactions with this server.</li>
<li><code>match=NONE</code> if the server has not previously seen the client&rsquo;s protocol. The serverHash and serverProtocol may also be non-null if the server&rsquo;s protocol hash was incorrect.
In this case the client must then re-submit its request with its protocol text (<code>clientHash!=null, clientProtocol!=null, serverHash!=null</code>) and the server should respond with a successful match (match=BOTH, serverProtocol=null, serverHash=null) as above.</li>
</ul>
</li>
</ul>
<p>The meta field is reserved for future handshake enhancements.</p>
<h3 id="call-format">Call Format</h3>
<p>A <em>call</em> consists of a request message paired with its resulting response or error message. Requests and responses contain extensible metadata, and both kinds of messages are framed as described above.</p>
<p>The format of a call request is:</p>
<ul>
<li><em>request metadata</em>, a map with values of type bytes</li>
<li>the <em>message name</em>, an Avro string, followed by</li>
<li>the <em>message parameters</em>. Parameters are serialized according to the message&rsquo;s request declaration.
When the empty string is used as a message name a server should ignore the parameters and return an empty response. A client may use this to ping a server or to perform a handshake without sending a protocol message.</li>
</ul>
<p>When a message is declared one-way and a stateful connection has been established by a successful handshake response, no response data is sent. Otherwise the format of the call response is:</p>
<ul>
<li><em>response metadata</em>, a map with values of type bytes</li>
<li>a one-byte error <em>flag</em> boolean, followed by either:
<ul>
<li>if the error flag is false, the message <em>response</em>, serialized per the message&rsquo;s response schema.</li>
<li>if the error flag is true, the <em>error</em>, serialized per the message&rsquo;s effective error union schema.</li>
</ul>
</li>
</ul>
<h3 id="schema-resolution">Schema Resolution</h3>
<p>A reader of Avro data, whether from an RPC or a file, can always parse that data because the original schema must be provided along with the data. However, the reader may be programmed to read data into a different schema. For example, if the data was written with a different version of the software than it is read, then fields may have been added or removed from records. This section specifies how such schema differences should be resolved.</p>
<p>We refer to the schema used to write the data as the writer&rsquo;s schema, and the schema that the application expects the reader&rsquo;s schema. Differences between these should be resolved as follows:</p>
<ul>
<li>
<p>It is an error if the two schemas do not <em>match</em>.
To match, one of the following must hold:</p>
<ul>
<li>both schemas are arrays whose item types match</li>
<li>both schemas are maps whose value types match</li>
<li>both schemas are enums whose (unqualified) names match</li>
<li>both schemas are fixed whose sizes and (unqualified) names match</li>
<li>both schemas are records with the same (unqualified) name</li>
<li>either schema is a union</li>
<li>both schemas have same primitive type</li>
<li>the writer&rsquo;s schema may be promoted to the reader&rsquo;s as follows:
<ul>
<li>int is promotable to long, float, or double</li>
<li>long is promotable to float or double</li>
<li>float is promotable to double</li>
<li>string is promotable to bytes</li>
<li>bytes is promotable to string</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>if both are records</strong>:</p>
<ul>
<li>the ordering of fields may be different: fields are matched by name.</li>
<li>schemas for fields with the same name in both records are resolved recursively.</li>
<li>if the writer&rsquo;s record contains a field with a name not present in the reader&rsquo;s record, the writer&rsquo;s value for that field is ignored.</li>
<li>if the reader&rsquo;s record schema has a field that contains a default value, and writer&rsquo;s schema does not have a field with the same name, then the reader should use the default value from its field.</li>
<li>if the reader&rsquo;s record schema has a field with no default value, and writer&rsquo;s schema does not have a field with the same name, an error is signalled.</li>
</ul>
</li>
<li>
<p><strong>if both are enums</strong>:
if the writer&rsquo;s symbol is not present in the reader&rsquo;s enum and the reader has a default value, then that value is used, otherwise an error is signalled.</p>
</li>
<li>
<p><strong>if both are arrays</strong>:
This resolution algorithm is applied recursively to the reader&rsquo;s and writer&rsquo;s array item schemas.</p>
</li>
<li>
<p><strong>if both are maps</strong>:
This resolution algorithm is applied recursively to the reader&rsquo;s and writer&rsquo;s value schemas.</p>
</li>
<li>
<p><strong>if both are unions</strong>:
The first schema in the reader&rsquo;s union that matches the selected writer&rsquo;s union schema is recursively resolved against it. if none match, an error is signalled.</p>
</li>
<li>
<p><strong>if reader&rsquo;s is a union, but writer&rsquo;s is not</strong>
The first schema in the reader&rsquo;s union that matches the writer&rsquo;s schema is recursively resolved against it. If none match, an error is signalled.</p>
</li>
<li>
<p><strong>if writer&rsquo;s is a union, but reader&rsquo;s is not</strong>
If the reader&rsquo;s schema matches the selected writer&rsquo;s schema, it is recursively resolved against it. If they do not match, an error is signalled.</p>
</li>
</ul>
<p>A schema&rsquo;s <em>doc</em> fields are ignored for the purposes of schema resolution. Hence, the <em>doc</em> portion of a schema may be dropped at serialization.</p>
<h3 id="parsing-canonical-form-for-schemas">Parsing Canonical Form for Schemas</h3>
<p>One of the defining characteristics of Avro is that a reader must use the schema used by the writer of the data in order to know how to read the data. This assumption results in a data format that&rsquo;s compact and also amenable to many forms of schema evolution. However, the specification so far has not defined what it means for the reader to have the &ldquo;same&rdquo; schema as the writer. Does the schema need to be textually identical? Well, clearly adding or removing some whitespace to a JSON expression does not change its meaning. At the same time, reordering the fields of records clearly does change the meaning. So what does it mean for a reader to have &ldquo;the same&rdquo; schema as a writer?</p>
<p>Parsing Canonical Form is a transformation of a writer&rsquo;s schema that let&rsquo;s us define what it means for two schemas to be &ldquo;the same&rdquo; for the purpose of reading data written against the schema. It is called Parsing Canonical Form because the transformations strip away parts of the schema, like &ldquo;doc&rdquo; attributes, that are irrelevant to readers trying to parse incoming data. It is called Canonical Form because the transformations normalize the JSON text (such as the order of attributes) in a way that eliminates unimportant differences between schemas. If the Parsing Canonical Forms of two different schemas are textually equal, then those schemas are &ldquo;the same&rdquo; as far as any reader is concerned, i.e., there is no serialized data that would allow a reader to distinguish data generated by a writer using one of the original schemas from data generated by a writing using the other original schema. (We sketch a proof of this property in a companion document.)</p>
<p>The next subsection specifies the transformations that define Parsing Canonical Form. But with a well-defined canonical form, it can be convenient to go one step further, transforming these canonical forms into simple integers (&ldquo;fingerprints&rdquo;) that can be used to uniquely identify schemas. The subsection after next recommends some standard practices for generating such fingerprints.</p>
<h4 id="transforming-into-parsing-canonical-form">Transforming into Parsing Canonical Form</h4>
<p>Assuming an input schema (in JSON form) that&rsquo;s already UTF-8 text for a <em>valid</em> Avro schema (including all quotes as required by JSON), the following transformations will produce its Parsing Canonical Form:</p>
<ul>
<li>[PRIMITIVES] Convert primitive schemas to their simple form (e.g., int instead of <code>{&quot;type&quot;:&quot;int&quot;}</code>).</li>
<li>[FULLNAMES] Replace short names with fullnames, using applicable namespaces to do so. Then eliminate namespace attributes, which are now redundant.</li>
<li>[STRIP] Keep only attributes that are relevant to parsing data, which are: <em>type</em>, <em>name</em>, <em>fields</em>, <em>symbols</em>, <em>items</em>, <em>values</em>, <em>size</em>. Strip all others (e.g., <em>doc</em> and <em>aliases</em>).</li>
<li>[ORDER] Order the appearance of fields of JSON objects as follows: <em>name</em>, <em>type</em>, <em>fields</em>, <em>symbols</em>, <em>items</em>, <em>values</em>, <em>size</em>. For example, if an object has <em>type</em>, <em>name</em>, and <em>size</em> fields, then the <em>name</em> field should appear first, followed by the <em>type</em> and then the <em>size</em> fields.</li>
<li>[STRINGS] For all JSON string literals in the schema text, replace any escaped characters (e.g., \uXXXX escapes) with their UTF-8 equivalents.</li>
<li>[INTEGERS] Eliminate quotes around and any leading zeros in front of JSON integer literals (which appear in the <em>size</em> attributes of <em>fixed</em> schemas).</li>
<li>[WHITESPACE] Eliminate all whitespace in JSON outside of string literals.</li>
</ul>
<h4 id="schema-fingerprints">Schema Fingerprints</h4>
<p>&ldquo;[A] fingerprinting algorithm is a procedure that maps an arbitrarily large data item (such as a computer file) to a much shorter bit string, its fingerprint, that uniquely identifies the original data for all practical purposes&rdquo; (quoted from <a href="https://en.wikipedia.org/wiki/Fingerprint_(computing)">Wikipedia</a>). In the Avro context, fingerprints of Parsing Canonical Form can be useful in a number of applications; for example, to cache encoder and decoder objects, to tag data items with a short substitute for the writer&rsquo;s full schema, and to quickly negotiate common-case schemas between readers and writers.</p>
<p>In designing fingerprinting algorithms, there is a fundamental trade-off between the length of the fingerprint and the probability of collisions. To help application designers find appropriate points within this trade-off space, while encouraging interoperability and ease of implementation, we recommend using one of the following three algorithms when fingerprinting Avro schemas:</p>
<ul>
<li>When applications can tolerate longer fingerprints, we recommend using the <a href="https://en.wikipedia.org/wiki/SHA-2">SHA-256 digest algorithm</a> to generate 256-bit fingerprints of Parsing Canonical Forms. Most languages today have SHA-256 implementations in their libraries.</li>
<li>At the opposite extreme, the smallest fingerprint we recommend is a 64-bit <a href="https://en.wikipedia.org/wiki/Rabin_fingerprint">Rabin fingerprint</a>. Below, we provide pseudo-code for this algorithm that can be easily translated into any programming language. 64-bit fingerprints should guarantee uniqueness for schema caches of up to a million entries (for such a cache, the chance of a collision is 3E-8). We don&rsquo;t recommend shorter fingerprints, as the chances of collisions is too great (for example, with 32-bit fingerprints, a cache with as few as 100,000 schemas has a 50% chance of having a collision).</li>
<li>Between these two extremes, we recommend using the <a href="https://en.wikipedia.org/wiki/MD5">MD5 message digest</a> to generate 128-bit fingerprints. These make sense only where very large numbers of schemas are being manipulated (tens of millions); otherwise, 64-bit fingerprints should be sufficient. As with SHA-256, MD5 implementations are found in most libraries today.</li>
</ul>
<p>These fingerprints are not meant to provide any security guarantees, even the longer SHA-256-based ones. Most Avro applications should be surrounded by security measures that prevent attackers from writing random data and otherwise interfering with the consumers of schemas. We recommend that these surrounding mechanisms be used to prevent collision and pre-image attacks (i.e., &ldquo;forgery&rdquo;) on schema fingerprints, rather than relying on the security properties of the fingerprints themselves.</p>
<p>Rabin fingerprints are <a href="https://en.wikipedia.org/wiki/Cyclic_redundancy_check">cyclic redundancy checks</a> computed using irreducible polynomials. In the style of the Appendix of <a href="https://www.ietf.org/rfc/rfc1952.txt">RFC 1952</a> (pg 10), which defines the CRC-32 algorithm, here&rsquo;s our definition of the 64-bit AVRO fingerprinting algorithm:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">fingerprint64</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">byte</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">buf</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">FP_TABLE</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#000">initFPTable</span><span style="color:#ce5c00;font-weight:bold">();</span>
  <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">EMPTY</span><span style="color:#ce5c00;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">buf</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">length</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++)</span>
    <span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">^</span> <span style="color:#000">FP_TABLE</span><span style="color:#ce5c00;font-weight:bold">[(</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#ce5c00;font-weight:bold">)(</span><span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">^</span> <span style="color:#000">buf</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">])</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000">0xff</span><span style="color:#ce5c00;font-weight:bold">];</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">fp</span><span style="color:#ce5c00;font-weight:bold">;</span>
<span style="color:#ce5c00;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">EMPTY</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0xc15d213aa4d7a795L</span><span style="color:#ce5c00;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">long</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">FP_TABLE</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">initFPTable</span><span style="color:#ce5c00;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">{</span>
  <span style="color:#000">FP_TABLE</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87;font-weight:bold">long</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">256</span><span style="color:#ce5c00;font-weight:bold">];</span>
  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">256</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++)</span>
      <span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">^</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">EMPTY</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#ce5c00;font-weight:bold">-(</span><span style="color:#000">fp</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000">1L</span><span style="color:#ce5c00;font-weight:bold">));</span>
    <span style="color:#000">FP_TABLE</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">fp</span><span style="color:#ce5c00;font-weight:bold">;</span>
  <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p>Readers interested in the mathematics behind this algorithm may want to read <a href="https://books.google.com/books?id=XD9iAwAAQBAJ&amp;pg=PA319">Chapter 14 of the Second Edition of Hacker&rsquo;s Delight</a>. (Unlike RFC-1952 and the book chapter, we prepend a single one bit to messages. We do this because CRCs ignore leading zero bits, which can be problematic. Our code prepends a one-bit by initializing fingerprints using EMPTY, rather than initializing using zero as in RFC-1952 and the book chapter.)</p>
<h2 id="logical-types">Logical Types</h2>
<p>A logical type is an Avro primitive or complex type with extra attributes to represent a derived type. The attribute <code>logicalType</code> must always be present for a logical type, and is a string with the name of one of the logical types listed later in this section. Other attributes may be defined for particular logical types.</p>
<p>A logical type is always serialized using its underlying Avro type so that values are encoded in exactly the same way as the equivalent Avro type that does not have a <code>logicalType</code> attribute. Language implementations may choose to represent logical types with an appropriate native type, although this is not required.</p>
<p>Language implementations must ignore unknown logical types when reading, and should use the underlying Avro type. If a logical type is invalid, for example a decimal with scale greater than its precision, then implementations should ignore the logical type and use the underlying Avro type.</p>
<h3 id="decimal">Decimal</h3>
<p>The <code>decimal</code> logical type represents an arbitrary-precision signed decimal number of the form <em>unscaled × 10<sup>-scale</sup></em>.</p>
<p>A <code>decimal</code> logical type annotates Avro <em>bytes</em> or <em>fixed</em> types. The byte array must contain the two&rsquo;s-complement representation of the unscaled integer value in big-endian byte order. The scale is fixed, and is specified using an attribute.</p>
<p>The following attributes are supported:</p>
<ul>
<li><em>scale</em>, a JSON integer representing the scale (optional). If not specified the scale is 0.</li>
<li><em>precision</em>, a JSON integer representing the (maximum) precision of decimals stored in this type (required).
For example, the following schema represents decimal numbers with a maximum precision of 4 and a scale of 2:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;logicalType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;decimal&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;precision&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;scale&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Precision must be a positive integer greater than zero. If the underlying type is a <em>fixed</em>, then the precision is limited by its size. An array of length n can store at most <em>floor(log<sub>10</sub>(2<sup>8 × n - 1</sup> - 1))</em> base-10 digits of precision.</p>
<p>Scale must be zero or a positive integer less than or equal to the precision.</p>
<p>For the purposes of schema resolution, two schemas that are <code>decimal</code> logical types <em>match</em> if their scales and precisions match.</p>
<h3 id="uuid">UUID</h3>
<p>The <code>uuid</code> logical type represents a random generated universally unique identifier (UUID).</p>
<p>A <code>uuid</code> logical type annotates an Avro <code>string</code>. The string has to conform with <a href="https://www.ietf.org/rfc/rfc4122.txt">RFC-4122</a></p>
<h3 id="date">Date</h3>
<p>The <code>date</code> logical type represents a date within the calendar, with no reference to a particular time zone or time of day.</p>
<p>A <code>date</code> logical type annotates an Avro <code>int</code>, where the int stores the number of days from the unix epoch, 1 January 1970 (ISO calendar).</p>
<p>The following schema represents a date:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;int&#34;</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#204a87;font-weight:bold">&#34;logicalType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;date&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="time-millisecond-precision">Time (millisecond precision)</h3>
<p>The <code>time-millis</code> logical type represents a time of day, with no reference to a particular calendar, time zone or date, with a precision of one millisecond.</p>
<p>A <code>time-millis</code> logical type annotates an Avro <code>int</code>, where the int stores the number of milliseconds after midnight, 00:00:00.000.</p>
<h3 id="time-microsecond-precision">Time (microsecond precision)</h3>
<p>The <code>time-micros</code> logical type represents a time of day, with no reference to a particular calendar, time zone or date, with a precision of one microsecond.</p>
<p>A <code>time-micros</code> logical type annotates an Avro long, where the long stores the number of microseconds after midnight, 00:00:00.000000.</p>
<h3 id="timestamp-millisecond-precision">Timestamp (millisecond precision)</h3>
<p>The <code>timestamp-millis</code> logical type represents an instant on the global timeline, independent of a particular time zone or calendar, with a precision of one millisecond. Please note that time zone information gets lost in this process. Upon reading a value back, we can only reconstruct the instant, but not the original representation. In practice, such timestamps are typically displayed to users in their local time zones, therefore they may be displayed differently depending on the execution environment.</p>
<p>A <code>timestamp-millis</code> logical type annotates an Avro long, where the long stores the number of milliseconds from the unix epoch, 1 January 1970 00:00:00.000 UTC.</p>
<h3 id="timestamp-microsecond-precision">Timestamp (microsecond precision)</h3>
<p>The <code>timestamp-micros</code> logical type represents an instant on the global timeline, independent of a particular time zone or calendar, with a precision of one microsecond. Please note that time zone information gets lost in this process. Upon reading a value back, we can only reconstruct the instant, but not the original representation. In practice, such timestamps are typically displayed to users in their local time zones, therefore they may be displayed differently depending on the execution environment.</p>
<p>A <code>timestamp-micros</code> logical type annotates an Avro long, where the long stores the number of microseconds from the unix epoch, 1 January 1970 00:00:00.000000 UTC.</p>
<h3 id="local-timestamp-millisecond-precision">Local timestamp (millisecond precision)</h3>
<p>The <code>local-timestamp-millis</code> logical type represents a timestamp in a local timezone, regardless of what specific time zone is considered local, with a precision of one millisecond.</p>
<p>A <code>local-timestamp-millis</code> logical type annotates an Avro long, where the long stores the number of milliseconds, from 1 January 1970 00:00:00.000.</p>
<h3 id="local-timestamp-microsecond-precision">Local timestamp (microsecond precision)</h3>
<p>The <code>local-timestamp-micros</code> logical type represents a timestamp in a local timezone, regardless of what specific time zone is considered local, with a precision of one microsecond.</p>
<p>A <code>local-timestamp-micros</code> logical type annotates an Avro long, where the long stores the number of microseconds, from 1 January 1970 00:00:00.000000.</p>
<h3 id="duration">Duration</h3>
<p>The <code>duration</code> logical type represents an amount of time defined by a number of months, days and milliseconds. This is not equivalent to a number of milliseconds, because, depending on the moment in time from which the duration is measured, the number of days in the month and number of milliseconds in a day may differ. Other standard periods such as years, quarters, hours and minutes can be expressed through these basic periods.</p>
<p>A <code>duration</code> logical type annotates Avro <code>fixed</code> type of size 12, which stores three little-endian unsigned integers that represent durations at different granularities of time. The first stores a number in months, the second stores a number in days, and the third stores a number in milliseconds.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-855fa3456d5ec5677548590b68db0334">5 - Java API</h1>
    
	<p>The Javadocs could be found <a href="https://avro.apache.org/docs/current/api/java/index.html">here</a></p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f288c30677a180f69252f486fe9fe630">6 - C API</h1>
    
	<p>The current version of Avro is 1.10.2. The current version of <code>libavro</code> is <code>23:0:0</code>. This document was created 2021-10-21.</p>
<h2 id="1-introduction-to-avro">1. Introduction to Avro</h2>
<p>Avro is a data serialization system.</p>
<p>Avro provides:</p>
<ul>
<li>Rich data structures.</li>
<li>A compact, fast, binary data format.</li>
<li>A container file, to store persistent data.</li>
<li>Remote procedure call (RPC).</li>
</ul>
<p>This document will focus on the C implementation of Avro. To learn more about Avro in general, visit the <a href="/">Avro website</a>.</p>
<h2 id="2-introduction-to-avro-c">2. Introduction to Avro C</h2>
<pre><code>    ___                      ______
   /   |_   ___________     / ____/
  / /| | | / / ___/ __ \   / /
 / ___ | |/ / /  / /_/ /  / /___
/_/  |_|___/_/   \____/   \____/
</code></pre><p><cite>A C program is like a fast dance on a newly waxed dance floor by people carrying razors.</cite> — Waldi Ravens</p>
<p>The C implementation has been tested on MacOSX and Linux but, over time, the number of support OSes should grow. Please let us know if you’re using <code>Avro C</code> on other systems.</p>
<p>Avro depends on the <a href="http://www.digip.org/jansson/">Jansson JSON parser</a>, version 2.3 or higher. On many operating systems this library is available through your package manager (for example, <code>apt-get install libjansson-dev</code> on Ubuntu/Debian, and <code>brew install jansson</code> on Mac OS). If not, please download and install it from source.</p>
<p>The C implementation supports:</p>
<ul>
<li>binary encoding/decoding of all primitive and complex data types</li>
<li>storage to an Avro Object Container File</li>
<li>schema resolution, promotion and projection</li>
<li>validating and non-validating mode for writing Avro data</li>
</ul>
<p>The C implementation is lacking:</p>
<ul>
<li>RPC</li>
</ul>
<p>To learn about the API, take a look at the examples and reference files later in this document.</p>
<p>We’re always looking for contributions so, if you’re a C hacker, please feel free to [submit patches to the project](TODO link to HOW TO CONTRIBUTE).</p>
<h2 id="3-error-reporting">3. Error reporting</h2>
<p>Most functions in the Avro C library return a single int status code. Following the POSIX <code>errno.h</code> convention, a status code of 0 indicates success. Non-zero codes indiciate an error condition. Some functions return a pointer value instead of an int status code; for these functions, a NULL pointer indicates an error.</p>
<p>You can retrieve a string description of the most recent error using the avro_strerror function:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_schema_t</span>  <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Error was %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="4-avro-values">4. Avro values</h2>
<p>Starting with version 1.6.0, the Avro C library has a new API for handling Avro data. To help distinguish between the two APIs, we refer to the old one as the <code>legacy</code> or <code>datum</code> API, and the new one as the <code>value</code> API. (These names come from the names of the C types used to represent Avro data in the corresponding API — <code>avro_datum_t</code> and <code>avro_value_t</code>.) The legacy API is still present, but it’s deprecated — you shouldn’t use the <code>avro_datum_t</code> type or the avro_datum_* functions in new code.</p>
<p>One main benefit of the new value API is that you can treat any existing C type as an Avro value; you just have to provide a custom implementation of the value interface. In addition, we provide a generic value implementation; “generic”, in this sense, meaning that this single implementation works for instances of any Avro schema type. Finally, we also provide a wrapper implementation for the deprecated avro_datum_t type, which lets you gradually transition to the new value API.</p>
<h3 id="41-avro-value-interface">4.1. Avro value interface</h3>
<p>You interact with Avro values using the value interface, which defines methods for setting and retrieving the contents of an Avro value. An individual value is represented by an instance of the avro_value_t type.</p>
<p>This section provides an overview of the methods that you can call on an avro_value_t instance. There are quite a few methods in the value interface, but not all of them make sense for all Avro schema types. For instance, you won’t be able to call avro_value_set_boolean on an Avro array value. If you try to call an inappropriate method, we’ll return an EINVAL error code.</p>
<p>Note that the functions in this section apply to all Avro values, regardless of which value implementation is used under the covers. This section doesn’t describe how to create value instances, since those constructors will be specific to a particular value implementation.</p>
<h4 id="411-common-methods">4.1.1. Common methods</h4>
<p>There are a handful of methods that can be used with any value, regardless of which Avro schema it’s an instance of:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">avro_type_t</span> <span style="color:#000">avro_value_get_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_schema_t</span> <span style="color:#000">avro_value_get_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_equal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">v1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">v2</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_equal_fast</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">v1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">v2</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_copy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_copy_fast</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#000">uint32_t</span> <span style="color:#000">avro_value_hash</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_reset</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The <code>get_type</code> and <code>get_schema</code> methods can be used to get information about what kind of Avro value a given avro_value_t instance represents. (For <code>get_schema</code>, you borrow the value’s reference to the schema; if you need to save it and ensure that it outlives the value, you need to call avro_schema_incref on it.)</p>
<p>The <code>equal</code> and <code>equal_fast</code> methods compare two values for equality. The two values do not have to have the same value implementations, but they do have to be instances of the same schema. (Not equivalent schemas; the same schema.) The equal method checks that the schemas match; the equal_fast method assumes that they do.</p>
<p>The copy and copy_fast methods copy the contents of one Avro value into another. (Where possible, this is done without copying the actual content of a bytes, string, or fixed value, using the avro_wrapped_buffer_t functions described in the next section.) Like equal, the two values must have the same schema; copy checks this, while copy_fast assumes it.</p>
<p>The hash method returns a hash value for the given Avro value. This can be used to construct hash tables that use Avro values as keys. The function works correctly even with maps; it produces a hash that doesn’t depend on the ordering of the elements of the map. Hash values are only meaningful for comparing values of exactly the same schema. Hash values are not guaranteed to be consistent across different platforms, or different versions of the Avro library. That means that it’s really only safe to use these hash values internally within the context of a single execution of a single application.</p>
<p>The reset method “clears out” an +avro_value_t instance, making sure that it’s ready to accept the contents of a new value. For scalars, this is usually a no-op, since the new value will just overwrite the old one. For arrays and maps, this removes any existing elements from the container, so that we can append the elements of the new value. For records and unions, this just recursively resets the fields or current branch.</p>
<h4 id="412-scalar-values">4.1.2. Scalar values</h4>
<p>The simplest case is handling instances of the scalar Avro schema types. In Avro, the scalars are all of the primitive schema types, as well as enum and fixed — i.e., anything that can’t contain another Avro value. Note that we use standard C99 types to represent the primitive contents of an Avro scalar.</p>
<p>To retrieve the contents of an Avro scalar, you can use one of the getter methods:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_boolean</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_long</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int64_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_null</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                          <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_enum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>For the most part, these should be self-explanatory. For bytes, string, and fixed values, the pointer to the underlying content is const — you aren’t allowed to modify the contents directly. We guarantee that the content of a string will be NUL-terminated, so you can use it as a C string as you’d expect. The size returned for a string object will include the NUL terminator; it will be one more than you’d get from calling strlen on the content.</p>
<p>Also, for bytes, string, and fixed, the dest and size parameters are optional; if you only want to determine the length of a bytes value, you can use:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_value_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#8f5902;font-style:italic">/* from somewhere */</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">size_t</span>  <span style="color:#000">size</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">avro_value_get_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>To set the contents of an Avro scalar, you can use one of the setter methods:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_boolean</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32_t</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_long</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int64_t</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_null</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_string_len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                              <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_enum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>These are also straightforward. For bytes, string, and fixed values, the set methods will make a copy of the underlying data. For string values, the content must be NUL-terminated. You can use set_string_len if you already know the length of the string content; the length you pass in should include the NUL terminator. If you call set_string, then we’ll use strlen to calculate the length.</p>
<p>For fixed values, the size must match what’s expected by the value’s underlying fixed schema; if the sizes don’t match, you’ll get an error code.</p>
<p>If you don’t want to copy the contents of a bytes, string, or fixed value, you can use the giver and grabber functions:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#000">void</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">avro_buf_free_t</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ptr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">sz</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">user_data</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_give_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_give_string_len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_give_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_grab_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_grab_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_grab_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">avro_wrapped_buffer</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">size_t</span>  <span style="color:#000">size</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">free</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">self</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">copy</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">size_t</span> <span style="color:#000">offset</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">length</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">self</span><span style="color:#000;font-weight:bold">,</span>
                 <span style="color:#000">size_t</span> <span style="color:#000">offset</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">length</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span> <span style="color:#000">avro_wrapped_buffer_t</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">void</span>
<span style="color:#000">avro_wrapped_buffer_free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span>
<span style="color:#000">avro_wrapped_buffer_copy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">src</span><span style="color:#000;font-weight:bold">,</span>
                         <span style="color:#000">size_t</span> <span style="color:#000">offset</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">length</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">int</span>
<span style="color:#000">avro_wrapped_buffer_slice</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_wrapped_buffer_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">self</span><span style="color:#000;font-weight:bold">,</span>
                          <span style="color:#000">size_t</span> <span style="color:#000">offset</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">length</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The <code>give</code> functions give control of an existing buffer to the value. (You should not try to free the src wrapped buffer after calling this method.) The grab function fills in a wrapped buffer with a pointer to the contents of an Avro value. (You should free the dest wrapped buffer when you’re done with it.)</p>
<p>The avro_wrapped_buffer_t struct encapsulates the location and size of the existing buffer. It also includes several methods. The free method will be called when the content of the buffer is no longer needed. The slice method will be called when the wrapped buffer needs to be updated to point at a subset of what it pointed at before. (This doesn’t create a new wrapped buffer; it updates an existing one.) The copy method will be called if the content needs to be copied. Note that if you’re wrapping a buffer with nice reference counting features, you don’t need to perform an actual copy; you just need to ensure that the free function can be called on both the original and the copy, and not have things blow up.</p>
<p>The “generic” value implementation takes advantage of this feature; if you pass in a wrapped buffer with a give method, and then retrieve it later with a grab method, then we’ll use the wrapped buffer’s copy method to fill in the dest parameter. If your wrapped buffer implements a slice method that updates reference counts instead of actually copying, then you’ve got nice zero-copy access to the contents of an Avro value.</p>
<h4 id="413-compound-values">4.1.3. Compound values</h4>
<p>The following sections describe the getter and setter methods for handling compound Avro values. All of the compound values are responsible for the storage of their children; this means that there isn’t a method, for instance, that lets you add an existing avro_value_t to an array. Instead, there’s a method that creates a new, empty avro_value_t of the appropriate type, adds it to the array, and returns it for you to fill in as needed.</p>
<p>You also shouldn’t try to free the child elements that are created this way; the container value is responsible for their life cycle. The child element is guaranteed to be valid for as long as the container value is. You’ll usually define an avro_value_t in the stack, and let it fall out of scope when you’re done with it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_value_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">array</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#8f5902;font-style:italic">/* from somewhere else */</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">avro_value_t</span>  <span style="color:#000">child</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">avro_value_get_by_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">child</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#8f5902;font-style:italic">/* do something interesting with the array element */</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h4 id="414-arrays">4.1.4. Arrays</h4>
<p>There are three methods that can be used with array values:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_size</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_by_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">unused</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">array</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span>
                      <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">new_index</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The get_size method returns the number of elements currently in the array. The get_by_index method fills in element to point at the array element with the given index. (You should use NULL for the unused parameter; it’s ignored for array values.)</p>
<p>The append method creates a new value, appends it to the array, and returns it in element. If new_index is given, then it will be filled in with the index of the new element.</p>
<h4 id="415-maps">4.1.5. Maps</h4>
<p>There are four methods that can be used with map values:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_size</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">map</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">map</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                           <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_by_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">map</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">map</span><span style="color:#000;font-weight:bold">,</span>
                   <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span>
                   <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">is_new</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The get_size method returns the number of elements currently in the map. Map elements can be retrieved either by their key (get_by_name) or by their numeric index (get_by_index). (Numeric indices in a map are based on the order that the elements were added to the map.) In either case, the method takes in an optional output parameter that let you retrieve the index associated with a key, and vice versa.</p>
<p>The add method will add a new value to the map, if the given key isn’t already present. If the key is present, then the existing value with be returned. The index parameter, if given, will be filled in the element’s index. The is_new parameter, if given, can be used to determine whether the mapped value is new or not.</p>
<h4 id="416-records">4.1.6. Records</h4>
<p>There are three methods that can be used with record values:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_size</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">record</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_by_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">record</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">**</span><span style="color:#000">field_name</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">record</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">field_name</span><span style="color:#000;font-weight:bold">,</span>
                           <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">element</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The get_size method returns the number of fields in the record. (You can also get this by querying the value’s schema, but for some implementations, this method can be faster.)</p>
<p>The get_by_index and get_by_name functions can be used to retrieve one of the fields in the record, either by its ordinal position within the record, or by the name of the underlying field. Like with maps, the methods take in an additional parameter that let you retrieve the index associated with a field name, and vice versa.</p>
<p>When possible, it’s recommended that you access record fields by their numeric index, rather than by their field name. For most implementations, this will be more efficient.</p>
<h4 id="417-unions">4.1.7. Unions</h4>
<p>There are three methods that can be used with union values:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">union_val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">disc</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_get_current_branch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">union_val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">branch</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_value_set_branch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">union_val</span><span style="color:#000;font-weight:bold">,</span>
                          <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">discriminant</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">branch</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>The get_discriminant and get_current_branch methods return the current state of the union value, without modifying which branch is currently selected. The set_branch method can be used to choose the active branch, filling in the branch value to point at the branch’s value instance. (Most implementations will be smart enough to detect when the desired branch is already selected, so you should always call this method unless you can guarantee that the right branch is already current.)</p>
<h3 id="42-creating-value-instances">4.2. Creating value instances</h3>
<p>Okay, so we’ve described how to interact with a value that you already have a pointer to, but how do you create one in the first place? Each implementation of the value interface must provide its own functions for creating avro_value_t instances for that class. The 10,000-foot view is to:</p>
<p>Get an implementation struct for the value implementation that you want to use. (This is represented by an avro_value_iface_t pointer.)</p>
<p>Use the implementation’s constructor function to allocate instances of that value implementation.</p>
<p>Do whatever you need to the value (using the avro_value_t methods described in the previous section).</p>
<p>Free the value instance, if necessary, using the implementation’s destructor function.</p>
<p>Free the implementation struct when you’re done creating value instances.</p>
<p>These steps use the following functions:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">avro_value_iface_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">avro_value_iface_incref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_iface_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">avro_value_iface_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_iface_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>Note that for most value implementations, it’s fine to reuse a single avro_value_t instance for multiple values, using the avro_value_reset function before filling in the instance for each value. (This helps reduce the number of malloc and free calls that your application will make.)</p>
<p>We provide a “generic” value implementation that will work (efficiently) for any Avro schema.</p>
<p>For most applications, you won’t need to write your own value implementation; the Avro C library provides an efficient “generic” implementation, which supports the full range of Avro schema types. There’s a good chance that you just want to use this implementation, rather than rolling your own. (The primary reason for rolling your own would be if you want to access the elements of a compound value using C syntax — for instance, translating an Avro record into a C struct.) You can use the following functions to create and work with a generic value implementation for a particular schema:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">avro_value_iface_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">avro_generic_class_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_generic_value_new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">avro_value_iface_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dest</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">avro_generic_value_free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">self</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>Combining all of this together, you might have the following snippet of code:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_schema_t</span>  <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_long</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000">avro_value_iface_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">iface</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_generic_class_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#000">avro_value_t</span>  <span style="color:#000">val</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">avro_generic_value_new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">/* Generate Avro longs from 0-499 */</span>
<span style="color:#204a87;font-weight:bold">int</span>  <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">500</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">avro_value_reset</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">avro_value_set_long</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#8f5902;font-style:italic">/* do something with the value */</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">avro_generic_value_free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_value_iface_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h2 id="5-reference-counting">5. Reference Counting</h2>
<p>Avro C does reference counting for all schema and data objects. When the number of references drops to zero, the memory is freed.</p>
<p>For example, to create and free a string, you would use:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_datum_t</span> <span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;This is my string&#34;</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#000;font-weight:bold">...</span>
<span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">string</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>Things get a little more complicated when you consider more elaborate schema and data structures.</p>
<p>For example, let’s say that you create a record with a single string field:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_datum_t</span> <span style="color:#000">example</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Example&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_datum_t</span> <span style="color:#000">solo_field</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Example field value&#34;</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#000">avro_record_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">example</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;solo&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">solo_field</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#000;font-weight:bold">...</span>
<span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">example</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>In this example, the solo_field datum would not be freed since it has two references: the original reference and a reference inside the Example record. The avro_datum_decref(example) call drops the number of reference to one. If you are finished with the solo_field schema, then you need to avro_schema_decref(solo_field) to completely dereference the solo_field datum and free it.</p>
<h2 id="6-wrap-it-and-give-it">6. Wrap It and Give It</h2>
<p>You’ll notice that some datatypes can be &ldquo;wrapped&rdquo; and &ldquo;given&rdquo;. This allows C programmers the freedom to decide who is responsible for the memory. Let’s take strings for example.</p>
<p>To create a string datum, you have three different methods:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000">avro_datum_t</span> <span style="color:#000">avro_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">str</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_datum_t</span> <span style="color:#000">avro_wrapstring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">str</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">avro_datum_t</span> <span style="color:#000">avro_givestring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">str</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>If you use, avro_string then Avro C will make a copy of your string and free it when the datum is dereferenced. In some cases, especially when dealing with large amounts of data, you want to avoid this memory copy. That’s where avro_wrapstring and avro_givestring can help.</p>
<p>If you use, avro_wrapstring then Avro C will do no memory management at all. It will just save a pointer to your data and it’s your responsibility to free the string.</p>
<p>Warning
When using avro_wrapstring, do not free the string before you dereference the string datum with avro_datum_decref().
Lastly, if you use avro_givestring then Avro C will free the string later when the datum is dereferenced. In a sense, you are &ldquo;giving&rdquo; responsibility for freeing the string to Avro C.</p>
<p>Warning
Don’t &ldquo;give&rdquo; Avro C a string that you haven’t allocated from the heap with e.g. malloc or strdup.</p>
<p>For example, don’t do this:</p>
<p>avro_datum_t bad_idea = avro_givestring(&ldquo;This isn&rsquo;t allocated on the heap&rdquo;);</p>
<h2 id="7-schema-validation">7. Schema Validation</h2>
<p>If you want to write a datum, you would use the following function</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">avro_write_data</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_writer_t</span> <span style="color:#000">writer</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#000">avro_schema_t</span> <span style="color:#000">writers_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>If you pass in a writers_schema, then you datum will be validated before it is sent to the writer. This check ensures that your data has the correct format. If you are certain your datum is correct, you can pass a NULL value for writers_schema and Avro C will not validate before writing.</p>
<p>Note
Data written to an Avro File Object Container is always validated.</p>
<h2 id="8-examples">8. Examples</h2>
<p>I’m not even supposed to be here today!</p>
<p>— Dante Hicks
Imagine you’re a free-lance hacker in Leonardo, New Jersey and you’ve been approached by the owner of the local Quick Stop Convenience store. He wants you to create a contact database case he needs to call employees to work on their day off.</p>
<p>You might build a simple contact system using Avro C like the following…</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">/*
</span><span style="color:#8f5902;font-style:italic"> * Licensed to the Apache Software Foundation (ASF) under one or more
</span><span style="color:#8f5902;font-style:italic"> * contributor license agreements.  See the NOTICE file distributed with
</span><span style="color:#8f5902;font-style:italic"> * this work for additional information regarding copyright ownership.
</span><span style="color:#8f5902;font-style:italic"> * The ASF licenses this file to you under the Apache License, Version 2.0
</span><span style="color:#8f5902;font-style:italic"> * (the &#34;License&#34;); you may not use this file except in compliance with
</span><span style="color:#8f5902;font-style:italic"> * the License.  You may obtain a copy of the License at
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * https://www.apache.org/licenses/LICENSE-2.0
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Unless required by applicable law or agreed to in writing, software
</span><span style="color:#8f5902;font-style:italic"> * distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span><span style="color:#8f5902;font-style:italic"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</span><span style="color:#8f5902;font-style:italic"> * implied.  See the License for the specific language governing
</span><span style="color:#8f5902;font-style:italic"> * permissions and limitations under the License.
</span><span style="color:#8f5902;font-style:italic"> */</span>

<span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#8f5902;font-style:italic">#ifdef DEFLATE_CODEC
</span><span style="color:#8f5902;font-style:italic">#define QUICKSTOP_CODEC  &#34;deflate&#34;
</span><span style="color:#8f5902;font-style:italic">#else
</span><span style="color:#8f5902;font-style:italic">#define QUICKSTOP_CODEC  &#34;null&#34;
</span><span style="color:#8f5902;font-style:italic">#endif
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">avro_schema_t</span> <span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">int64_t</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#8f5902;font-style:italic">/* A simple schema for our tutorial */</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span>  <span style="color:#000">PERSON_SCHEMA</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span>
<span style="color:#4e9a06">&#34;{</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">record</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">,\
</span><span style="color:#4e9a06">  </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Person</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">,\
</span><span style="color:#4e9a06">  </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">fields</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">:[\
</span><span style="color:#4e9a06">     {</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">ID</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">long</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">},\
</span><span style="color:#4e9a06">     {</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">First</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">string</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">},\
</span><span style="color:#4e9a06">     {</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Last</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">string</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">},\
</span><span style="color:#4e9a06">     {</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Phone</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">string</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">},\
</span><span style="color:#4e9a06">     {</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Age</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">int</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">}]}&#34;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#8f5902;font-style:italic">/* Parse schema into a schema data structure */</span>
<span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">init_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_schema_from_json_literal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PERSON_SCHEMA</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unable to parse person schema</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/* Create a value to match the person schema and save it */</span>
<span style="color:#204a87;font-weight:bold">void</span>
<span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_file_writer_t</span> <span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">first</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">last</span><span style="color:#000;font-weight:bold">,</span>
           <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">phone</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32_t</span> <span style="color:#000">age</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_value_iface_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">person_class</span> <span style="color:#ce5c00;font-weight:bold">=</span>
            <span style="color:#000">avro_generic_class_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_value_t</span>  <span style="color:#000">person</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_generic_value_new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_class</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_value_t</span> <span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_value_t</span> <span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_value_t</span> <span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_value_t</span> <span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_value_t</span> <span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ID&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_value_set_long</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;First&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_value_set_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">first</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Last&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_value_set_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">last</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_value_set_int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">age</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Phone&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_value_set_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">phone</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_file_writer_append_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;Unable to write Person value to memory buffer</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">Message: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#8f5902;font-style:italic">/* Decrement all our references to prevent memory from leaking */</span>
        <span style="color:#000">avro_value_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_value_iface_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_class</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">print_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_file_reader_t</span> <span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_t</span> <span style="color:#000">reader_schema</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>

        <span style="color:#000">avro_value_iface_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">person_class</span> <span style="color:#ce5c00;font-weight:bold">=</span>
            <span style="color:#000">avro_generic_class_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_value_t</span> <span style="color:#000">person</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_generic_value_new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_class</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">rval</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">rval</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_file_reader_read_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">int64_t</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">int32_t</span> <span style="color:#000">age</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">int32_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">size_t</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_value_t</span> <span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_value_t</span> <span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_value_t</span> <span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_value_t</span> <span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_value_t</span> <span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">;</span>

                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ID&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">avro_value_get_long</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;%&#34;</span><span style="color:#000">PRId64</span><span style="color:#4e9a06">&#34; | &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;First&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">avro_value_get_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">first_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;%15s | &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">p</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Last&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">avro_value_get_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">last_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;%15s | &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">p</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Phone&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">avro_value_get_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">phone_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;%15s | &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">p</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_value_get_by_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">avro_value_get_int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age_value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;%&#34;</span><span style="color:#000">PRId32</span><span style="color:#4e9a06">&#34; | &#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">age</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>

                <span style="color:#8f5902;font-style:italic">/* We no longer need this memory */</span>
                <span style="color:#000">avro_value_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">person</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_value_iface_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_class</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">rval</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">rval</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_file_reader_t</span> <span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_file_writer_t</span> <span style="color:#000">db</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">projection_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">first_name_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">phone_schema</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">int64_t</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">dbname</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;quickstop.db&#34;</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">number</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">15</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">};</span>

        <span style="color:#8f5902;font-style:italic">/* Initialize the schema structure from JSON */</span>
        <span style="color:#000">init_schema</span><span style="color:#000;font-weight:bold">();</span>

        <span style="color:#8f5902;font-style:italic">/* Delete the database if it exists */</span>
        <span style="color:#000">remove</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbname</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#8f5902;font-style:italic">/* Create a new database */</span>
        <span style="color:#000">rval</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_file_writer_create_with_codec</span>
            <span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbname</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">QUICKSTOP_CODEC</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;There was an error creating %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dbname</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34; error message: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#8f5902;font-style:italic">/* Add lots of people to the database */</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">1000</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">sprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">number</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(%d)&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Dante&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Hicks&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">number</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">32</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Randal&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Graves&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(555) 123-5678&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">30</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Veronica&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Loughran&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(555) 123-0987&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Caitlin&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Bree&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(555) 123-2323&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">27</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Bob&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Silent&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(555) 123-6422&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">29</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Jay&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;???&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">number</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">26</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#8f5902;font-style:italic">/* Close the block and open a new one */</span>
        <span style="color:#000">avro_file_writer_flush</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">add_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Super&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Man&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;123456&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">31</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_file_writer_close</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">db</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">Now let&#39;s read all the records back out</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">/* Read all the records and print them */</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_file_reader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbname</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Error opening file: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">print_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Error printing person</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">Message: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">avro_file_reader_close</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">/* You can also use projection, to only decode only the data you are
</span><span style="color:#8f5902;font-style:italic">           interested in.  This is particularly useful when you have
</span><span style="color:#8f5902;font-style:italic">           huge data sets and you&#39;ll only interest in particular fields
</span><span style="color:#8f5902;font-style:italic">           e.g. your contacts First name and phone number */</span>
        <span style="color:#000">projection_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Person&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">first_name_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">phone_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_record_field_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">projection_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;First&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                        <span style="color:#000">first_name_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_record_field_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">projection_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Phone&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                        <span style="color:#000">phone_schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">/* Read only the record you&#39;re interested in */</span>
        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stdout</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\n\n</span><span style="color:#4e9a06">Use projection to print only the First name and phone numbers</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_file_reader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbname</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Error opening file: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">print_person</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">projection_schema</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Error printing person: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">avro_file_reader_close</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dbreader</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">first_name_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">phone_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">projection_schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">/* We don&#39;t need this schema anymore */</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">person_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>When you compile and run this program, you should get the following output</p>
<pre><code>Successfully added Hicks, Dante id=1
Successfully added Graves, Randal id=2
Successfully added Loughran, Veronica id=3
Successfully added Bree, Caitlin id=4
Successfully added Silent, Bob id=5
Successfully added ???, Jay id=6
</code></pre><p>Avro is compact. Here is the data for all 6 people.</p>
<pre><code>| 02 0A 44 61 6E 74 65 0A | 48 69 63 6B 73 1C 28 35 |   ..Dante.Hicks.(5
| 35 35 29 20 31 32 33 2D | 34 35 36 37 40 04 0C 52 |   55) 123-4567@..R
| 61 6E 64 61 6C 0C 47 72 | 61 76 65 73 1C 28 35 35 |   andal.Graves.(55
| 35 29 20 31 32 33 2D 35 | 36 37 38 3C 06 10 56 65 |   5) 123-5678&lt;..Ve
| 72 6F 6E 69 63 61 10 4C | 6F 75 67 68 72 61 6E 1C |   ronica.Loughran.
| 28 35 35 35 29 20 31 32 | 33 2D 30 39 38 37 38 08 |   (555) 123-09878.
| 0E 43 61 69 74 6C 69 6E | 08 42 72 65 65 1C 28 35 |   .Caitlin.Bree.(5
| 35 35 29 20 31 32 33 2D | 32 33 32 33 36 0A 06 42 |   55) 123-23236..B
| 6F 62 0C 53 69 6C 65 6E | 74 1C 28 35 35 35 29 20 |   ob.Silent.(555)
| 31 32 33 2D 36 34 32 32 | 3A 0C 06 4A 61 79 06 3F |   123-6422:..Jay.?
| 3F 3F 1C 28 35 35 35 29 | 20 31 32 33 2D 39 31 38 |   ??.(555) 123-918
| 32 34 .. .. .. .. .. .. | .. .. .. .. .. .. .. .. |   24..............
</code></pre><p>Now let&rsquo;s read all the records back out
1 |           Dante |           Hicks |  (555) 123-4567 | 32
2 |          Randal |          Graves |  (555) 123-5678 | 30
3 |        Veronica |        Loughran |  (555) 123-0987 | 28
4 |         Caitlin |            Bree |  (555) 123-2323 | 27
5 |             Bob |          Silent |  (555) 123-6422 | 29
6 |             Jay |             ??? |  (555) 123-9182 | 26</p>
<p>Use projection to print only the First name and phone numbers
Dante |  (555) 123-4567 |
Randal |  (555) 123-5678 |
Veronica |  (555) 123-0987 |
Caitlin |  (555) 123-2323 |
Bob |  (555) 123-6422 |
Jay |  (555) 123-9182 |
The Quick Stop owner was so pleased, he asked you to create a movie database for his RST Video store.</p>
<h2 id="9-reference-files">9. Reference files</h2>
<h3 id="91-avroh">9.1. avro.h</h3>
<p>The avro.h header file contains the complete public API for Avro C. The documentation is rather sparse right now but we’ll be adding more information soon.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">/*
</span><span style="color:#8f5902;font-style:italic"> * Licensed to the Apache Software Foundation (ASF) under one or more
</span><span style="color:#8f5902;font-style:italic"> * contributor license agreements.  See the NOTICE file distributed with
</span><span style="color:#8f5902;font-style:italic"> * this work for additional information regarding copyright ownership.
</span><span style="color:#8f5902;font-style:italic"> * The ASF licenses this file to you under the Apache License, Version 2.0
</span><span style="color:#8f5902;font-style:italic"> * (the &#34;License&#34;); you may not use this file except in compliance with
</span><span style="color:#8f5902;font-style:italic"> * the License.  You may obtain a copy of the License at
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * https://www.apache.org/licenses/LICENSE-2.0
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Unless required by applicable law or agreed to in writing, software
</span><span style="color:#8f5902;font-style:italic"> * distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span><span style="color:#8f5902;font-style:italic"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</span><span style="color:#8f5902;font-style:italic"> * implied.  See the License for the specific language governing
</span><span style="color:#8f5902;font-style:italic"> * permissions and limitations under the License.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#8f5902;font-style:italic">#ifndef AVRO_H
</span><span style="color:#8f5902;font-style:italic">#define AVRO_H
</span><span style="color:#8f5902;font-style:italic">#ifdef __cplusplus
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">extern</span> <span style="color:#4e9a06">&#34;C&#34;</span> <span style="color:#000;font-weight:bold">{</span>
<span style="color:#8f5902;font-style:italic">#define CLOSE_EXTERN }
</span><span style="color:#8f5902;font-style:italic">#else
</span><span style="color:#8f5902;font-style:italic">#define CLOSE_EXTERN
</span><span style="color:#8f5902;font-style:italic">#endif
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/allocation.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/basics.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/consumer.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/data.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/errors.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/generic.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/io.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/legacy.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/platform.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/resolver.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/schema.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;avro/value.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#000">CLOSE_EXTERN</span>
<span style="color:#8f5902;font-style:italic">#endif
</span></code></pre></div><h3 id="92-test_avro_datac">9.2. test_avro_data.c</h3>
<p>Another good way to learn how to encode/decode data in Avro C is to look at the test_avro_data.c unit test. This simple unit test checks that all the avro types can be encoded/decoded correctly.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8f5902;font-style:italic">/*
</span><span style="color:#8f5902;font-style:italic"> * Licensed to the Apache Software Foundation (ASF) under one or more
</span><span style="color:#8f5902;font-style:italic"> * contributor license agreements.  See the NOTICE file distributed with
</span><span style="color:#8f5902;font-style:italic"> * this work for additional information regarding copyright ownership.
</span><span style="color:#8f5902;font-style:italic"> * The ASF licenses this file to you under the Apache License, Version 2.0
</span><span style="color:#8f5902;font-style:italic"> * (the &#34;License&#34;); you may not use this file except in compliance with
</span><span style="color:#8f5902;font-style:italic"> * the License.  You may obtain a copy of the License at
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * https://www.apache.org/licenses/LICENSE-2.0
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Unless required by applicable law or agreed to in writing, software
</span><span style="color:#8f5902;font-style:italic"> * distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span><span style="color:#8f5902;font-style:italic"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</span><span style="color:#8f5902;font-style:italic"> * implied.  See the License for the specific language governing
</span><span style="color:#8f5902;font-style:italic"> * permissions and limitations under the License.
</span><span style="color:#8f5902;font-style:italic"> */</span>

<span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;avro.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;avro_private.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;limits.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;string.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;time.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">buf</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4096</span><span style="color:#000;font-weight:bold">];</span>
<span style="color:#000">avro_reader_t</span> <span style="color:#000">reader</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">avro_writer_t</span> <span style="color:#000">writer</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">typedef</span> <span style="color:#000">int</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">avro_test</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">/*
</span><span style="color:#8f5902;font-style:italic"> * Use a custom allocator that verifies that the size that we use to
</span><span style="color:#8f5902;font-style:italic"> * free an object matches the size that we use to allocate it.
</span><span style="color:#8f5902;font-style:italic"> */</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span>
<span style="color:#000">test_allocator</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ud</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ptr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">osize</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">nsize</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">AVRO_UNUSED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ud</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">AVRO_UNUSED</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">osize</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">nsize</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">size_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">((</span><span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">ptr</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">osize</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#4e9a06">&#34;Error freeing %p:</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span>
                                <span style="color:#4e9a06">&#34;Size passed to avro_free (%&#34;</span> <span style="color:#000">PRIsz</span> <span style="color:#4e9a06">&#34;) &#34;</span>
                                <span style="color:#4e9a06">&#34;doesn&#39;t match size passed to &#34;</span>
                                <span style="color:#4e9a06">&#34;avro_malloc (%&#34;</span> <span style="color:#000">PRIsz</span> <span style="color:#4e9a06">&#34;)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">ptr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">osize</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
                        <span style="color:#000">abort</span><span style="color:#000;font-weight:bold">();</span>
                        <span style="color:#8f5902;font-style:italic">//exit(EXIT_FAILURE);
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#000">free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">size</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">size_t</span>  <span style="color:#000">real_size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">nsize</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">size_t</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">size_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">old_size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ptr</span><span style="color:#ce5c00;font-weight:bold">?</span> <span style="color:#000;font-weight:bold">((</span><span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">ptr</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">size_t</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">size_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">realloc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">old_size</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">real_size</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">nsize</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">init_rand</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">srand</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">time</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">));</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">rand_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">from</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">to</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">range</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">to</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">from</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">from</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000;font-weight:bold">((</span><span style="color:#204a87;font-weight:bold">double</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">rand</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">RAND_MAX</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">int64_t</span> <span style="color:#000">rand_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">int64_t</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">rand_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LONG_MIN</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LONG_MAX</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">int32_t</span> <span style="color:#000">rand_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">int32_t</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">rand_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">INT_MIN</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">INT_MAX</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">void</span>
<span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_schema_t</span> <span style="color:#000">writers_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                 <span style="color:#000">avro_schema_t</span> <span style="color:#000">readers_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_datum_t</span> <span style="color:#000">expected</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">type</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum_out</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">validate</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">validate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">validate</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">validate</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>

                <span style="color:#000">reader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_reader_memory</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">));</span>
                <span style="color:#000">writer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_writer_memory</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buf</span><span style="color:#000;font-weight:bold">));</span>

                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">expected</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">expected</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#8f5902;font-style:italic">/* Validating read/write */</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_write_data</span>
                    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span> <span style="color:#ce5c00;font-weight:bold">?</span> <span style="color:#f57900">writers_schema</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unable to write %s validate=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">  %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#000">int64_t</span> <span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span>
                    <span style="color:#000">avro_size_data</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span> <span style="color:#ce5c00;font-weight:bold">?</span> <span style="color:#f57900">writers_schema</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span>
                                   <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">avro_writer_tell</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#4e9a06">&#34;Unable to calculate size %s validate=%d &#34;</span>
                                <span style="color:#4e9a06">&#34;(%&#34;</span><span style="color:#000">PRId64</span><span style="color:#4e9a06">&#34; != %&#34;</span><span style="color:#000">PRId64</span><span style="color:#4e9a06">&#34;)</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">  %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_writer_tell</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer</span><span style="color:#000;font-weight:bold">),</span>
                                <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_read_data</span>
                    <span style="color:#000;font-weight:bold">(</span><span style="color:#000">reader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">writers_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">readers_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">datum_out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unable to read %s validate=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">  %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;  %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">avro_datum_equal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">expected</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum_out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#4e9a06">&#34;Unable to encode/decode %s validate=%d</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">  %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">validate</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#000">avro_reader_dump</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reader</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum_out</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_reader_free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reader</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_writer_free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">expected</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">char</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">json</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_to_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">strcasecmp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">expected</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected JSON encoding: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">free</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;Four score and seven years ago&#34;</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#4e9a06">&#34;our father brought forth on this continent&#34;</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#4e9a06">&#34;a new nation&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;conceived in Liberty&#34;</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#4e9a06">&#34;and dedicated to the proposition that all men are created equal.&#34;</span>
        <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">writer_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]);</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givestring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givestring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Four score and seven years ago</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">// The following should bork if we don&#39;t copy the string value
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// correctly (since we&#39;ll try to free a static string).
</span><span style="color:#8f5902;font-style:italic"></span>
        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;this should be copied&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_string_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;also this&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">0xDE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xAD</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xBE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xEF</span> <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">writer_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_bytes</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givebytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;\\</span><span style="color:#4e9a06">u00de</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">u00ad</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">u00be</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">u00ef</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givebytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_givebytes_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">expected_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givebytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">avro_datum_equal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;Expected equal bytes instances.</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">// The following should bork if we don&#39;t copy the bytes value
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// correctly (since we&#39;ll try to free a static string).
</span><span style="color:#8f5902;font-style:italic"></span>
        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_bytes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;original&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_bytes_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;alsothis&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">writer_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_int</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">long_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_long</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">float_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_float</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">double_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_double</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">int32_t</span>  <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rand_int32</span><span style="color:#000;font-weight:bold">();</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">long_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">float_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">double_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;int&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">long_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">long_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;int-&gt;long&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">float_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">float_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;int-&gt;float&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;int-&gt;double&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">long_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">float_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10000</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;10000&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">long_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">float_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">writer_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_long</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">float_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_float</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">double_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_double</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">int64_t</span>  <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rand_int64</span><span style="color:#000;font-weight:bold">();</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">float_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">double_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">float_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">float_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;long-&gt;float&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;long-&gt;double&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">float_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10000</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;10000&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">writer_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">float_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_double</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rand_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1.0E10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0E10</span><span style="color:#000;font-weight:bold">));</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;double&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2000.0</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;2000.0&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_float</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">double_schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_double</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">float</span>  <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rand_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1.0E10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0E10</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">double_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_double</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;float&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;float-&gt;double&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2000.0</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;2000.0&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">double_schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_boolean</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">expected_json</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;false&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;true&#34;</span> <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_boolean</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_boolean</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;boolean&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">expected_json</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_null</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_null</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_null</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;person&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_record_field_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">());</span>
        <span style="color:#000">avro_schema_record_field_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_int</span><span style="color:#000;font-weight:bold">());</span>

        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">name_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">age_datum</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">name_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givestring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Joseph Campbell&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">age_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">83</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_record_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_record_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">age_datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;{</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Joseph Campbell</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">age</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 83}&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">int</span>  <span style="color:#000">rc</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_record_set_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">104</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">int32_t</span>  <span style="color:#000">age</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_record_get_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">age</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">age</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">104</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Incorrect age value</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">age_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_nested_record</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">json</span> <span style="color:#ce5c00;font-weight:bold">=</span>
                <span style="color:#4e9a06">&#34;{&#34;</span>
                <span style="color:#4e9a06">&#34;  </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">record</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">,&#34;</span>
                <span style="color:#4e9a06">&#34;  </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">list</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">,&#34;</span>
                <span style="color:#4e9a06">&#34;  </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">fields</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: [&#34;</span>
                <span style="color:#4e9a06">&#34;    { </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">x</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">int</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06"> },&#34;</span>
                <span style="color:#4e9a06">&#34;    { </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">y</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">int</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06"> },&#34;</span>
                <span style="color:#4e9a06">&#34;    { </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">name</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">next</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">type</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: [</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">null</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">,</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">list</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">]}&#34;</span>
                <span style="color:#4e9a06">&#34;  ]&#34;</span>
                <span style="color:#4e9a06">&#34;}&#34;</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#204a87;font-weight:bold">int</span>  <span style="color:#000">rval</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_error_t</span> <span style="color:#000">error</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_from_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">strlen</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">error</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">head</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_datum_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_record_set_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">head</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;x&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_record_set_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">head</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;y&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">next</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span>  <span style="color:#000">tail</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">avro_record_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">head</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;next&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">next</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_union_set_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">next</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">tail</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_record_set_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">tail</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;x&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_record_set_field_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">tail</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">int32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;y&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_record_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tail</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;next&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">next</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_union_set_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">next</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">head</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;nested record&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">head</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_enum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">enum</span> <span style="color:#000">avro_languages</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">AVRO_C</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">AVRO_CPP</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">AVRO_PYTHON</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">AVRO_RUBY</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">AVRO_JAVA</span>
        <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_enum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;language&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_enum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">AVRO_C</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_enum_symbol_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;C&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_enum_symbol_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;C++&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_enum_symbol_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Python&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_enum_symbol_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Ruby&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_enum_symbol_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Java&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_enum_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">AVRO_C</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected enum value AVRO_C</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">strcmp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_enum_get_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#4e9a06">&#34;C&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected enum value name C</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">C</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_enum_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">AVRO_CPP</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">strcmp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_enum_get_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#4e9a06">&#34;C++&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected enum value name C++</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">C++</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_enum_set_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Python&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_enum_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">AVRO_PYTHON</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected enum value AVRO_PYTHON</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Python</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_array</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rval</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_array</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_schema_int</span><span style="color:#000;font-weight:bold">());</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_array</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">i32_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">rval</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_array_append_datum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i32_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i32_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rval</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_array_size</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected array size&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;array&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_map</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_map</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_schema_long</span><span style="color:#000;font-weight:bold">());</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_map</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">int64_t</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">nums</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span>
            <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;zero&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;one&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;two&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;three&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;four&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;five&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;six&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span> <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">nums</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">])</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">avro_datum_t</span> <span style="color:#000">i_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_int64</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_map_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">nums</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">i_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i_datum</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_array_size</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected map size</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">avro_datum_t</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">char</span>  <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_map_get_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_map_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">int64_t</span>  <span style="color:#000">val</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_int64_get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">val</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected map value 2</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">int</span>  <span style="color:#000">index</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_map_get_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;two&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Can&#39;t get index for key </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">two</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: %s</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#000">avro_strerror</span><span style="color:#000;font-weight:bold">());</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">index</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected index for key </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">two</span><span style="color:#4e9a06">\&#34;\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">avro_map_get_index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;foobar&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">index</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected index for key </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">foobar</span><span style="color:#4e9a06">\&#34;\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span>
                  <span style="color:#4e9a06">&#34;{</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">zero</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 0, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">one</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 1, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">two</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 2, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">three</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 3, &#34;</span>
                  <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">four</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 4, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">five</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 5, </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">six</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: 6}&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_union</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_union</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">union_datum1</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum1</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">avro_schema_union_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_string</span><span style="color:#000;font-weight:bold">());</span>
        <span style="color:#000">avro_schema_union_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_int</span><span style="color:#000;font-weight:bold">());</span>
        <span style="color:#000">avro_schema_union_append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">avro_schema_null</span><span style="color:#000;font-weight:bold">());</span>

        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givestring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Follow your bliss.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">union_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_union</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_union_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected union discriminant</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">avro_union_current_branch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Unexpected union branch datum</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">union_datum1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_datum_from_schema</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_union_set_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">datum1</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_givestring_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Follow your bliss.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">avro_datum_equal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum1</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Union values should be equal</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;union&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;{</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">string</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">: </span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">Follow your bliss.</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">}&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_union_set_discriminant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">union_datum1</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">static</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">test_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#0000cf;font-weight:bold">0xD</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xA</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xD</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xA</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xB</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xA</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xB</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0xA</span> <span style="color:#000;font-weight:bold">};</span>
        <span style="color:#000">avro_schema_t</span> <span style="color:#000">schema</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_schema_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">));</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000">avro_datum_t</span> <span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givefixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">write_read_check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">test_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">\&#34;\\</span><span style="color:#4e9a06">r</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">n</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">r</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">n</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">u000b</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">n</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">u000b</span><span style="color:#4e9a06">\\</span><span style="color:#4e9a06">n</span><span style="color:#4e9a06">\&#34;</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givefixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_givefixed_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">expected_datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_givefixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">avro_datum_equal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;Expected equal fixed instances.</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">expected_datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">// The following should bork if we don&#39;t copy the fixed value
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#8f5902;font-style:italic">// correctly (since we&#39;ll try to free a static string).
</span><span style="color:#8f5902;font-style:italic"></span>
        <span style="color:#000">datum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">avro_fixed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;original&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_fixed_set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;alsothis&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">avro_datum_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">datum</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#000">avro_schema_decref</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schema</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">void</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">avro_set_allocator</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">test_allocator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">NULL</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">avro_tests</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">avro_test</span> <span style="color:#000">func</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">tests</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_string</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;bytes&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_bytes</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;int&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_int32</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;long&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_int64</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;float&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_float</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;double&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_double</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;boolean&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_boolean</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;null&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_null</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;record&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_record</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;nested_record&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_nested_record</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;enum&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_enum</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;array&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_array</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;map&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_map</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;fixed&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_fixed</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#4e9a06">&#34;union&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test_union</span><span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">};</span>

        <span style="color:#000">init_rand</span><span style="color:#000;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tests</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#204a87;font-weight:bold">sizeof</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]);</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">avro_tests</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">test</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">tests</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000">fprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stderr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;**** Running %s tests ****</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">test</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">test</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">func</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">EXIT_FAILURE</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">EXIT_SUCCESS</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e2d3067f4d925eb37135a13ed88d2428">7 - Core Tasks</h1>
    <div class="lead">What can your user do with your project?</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page that shows you how to use this template site.</p>

</div>

<p>Think about your project’s features and use cases. Use these to choose your core tasks. Each granular use case (enable x, configure y) should have a corresponding tasks page or tasks page section. Users should be able to quickly refer to your core tasks when they need to find out how to do one specific thing, rather than having to look for the instructions in a bigger tutorial or example. Think of your tasks pages as a cookbook with different procedures your users can combine to create something more substantial.</p>
<p>You can give each task a page, or you can group related tasks together in a page, such as tasks related to a particular feature. As well as grouping related tasks in single pages, you can also group task pages in nested folders with an index page as an overview, as seen in this example site. Or if you have a small docset like the <a href="https://docsy.dev/docs/">Docsy User Guide</a> with no Tutorials or Concepts pages, consider adding your feature-specific pages at the top level of your docs rather than in a Tasks section.</p>
<p>Each task should give the user</p>
<ul>
<li>The prerequisites for this task, if any (this can be specified at the top of a multi-task page if they&rsquo;re the same for all the page&rsquo;s tasks. &ldquo;All these tasks assume that you understand&hellip;.and that you have already&hellip;.&quot;).</li>
<li>What this task accomplishes.</li>
<li>Instructions for the task. If it involves editing a file, running a command, or writing code, provide code-formatted example snippets to show the user what to do! If there are multiple steps, provide them as a numbered list.</li>
<li>If appropriate, links to related concept, tutorial, or example pages.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-525d55e5e5eaf1ca7138046ef31cd022">7.1 - Bed and Chair Metrics</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8b9ed72c94082e62654acbe5544809a4">7.2 - Porridge Assessment</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2acd4be46aab21e87082be97de87c74d">7.3 - Another Task</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-013e157738e63d8c3f90b39d559e8c8d">7.4 - Working with Ponycopters</h1>
    <div class="lead">A short lead description about this section page. Text here can also be <strong>bold</strong> or <em>italic</em> and can even be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>This is the section landing page.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-ab480eb0e8e417eb7cd925a592e0cbcc">7.4.1 - Configuring Ponycopters</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3662f29ce4d0c9029454f98cd85d98ca">7.4.2 - Launching Ponycopters</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8dbd4e302cd86a4d0f71f71ce3b300de">8 - Tutorials</h1>
    <div class="lead">Show your user how to work through some end to end examples.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page that shows you how to use this template site.</p>

</div>

<p>Tutorials are <strong>complete worked examples</strong> made up of <strong>multiple tasks</strong> that guide the user through a relatively simple but realistic scenario: building an application that uses some of your project’s features, for example. If you have already created some Examples for your project you can base Tutorials on them. This section is <strong>optional</strong>. However, remember that although you may not need this section at first, having tutorials can be useful to help your users engage with your example code, especially if there are aspects that need more explanation than you can easily provide in code comments.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-06285b237e6e217b13f8d9c941a9de18">8.1 - Multi-Bear Domicile Setup</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c86b0cbc9ee1f95a6facb6bff0282978">8.2 - Another Tutorial</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>
<p>Add some sections here to see how the ToC looks like. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
<h3 id="this-document">This Document</h3>
<p>Inguina genus: Anaphen post: lingua violente voce suae meus aetate diversi. Orbis unam nec flammaeque status deam Silenum erat et a ferrea. Excitus rigidum ait: vestro et Herculis convicia: nitidae deseruit coniuge Proteaque adiciam <em>eripitur</em>? Sitim noceat signa <em>probat quidem</em>. Sua longis <em>fugatis</em> quidem genae.</p>
<h3 id="pixel-count">Pixel Count</h3>
<p>Tilde photo booth wayfarers cliche lomo intelligentsia man braid kombucha vaporware farm-to-table mixtape portland. PBR&amp;B pickled cornhole ugh try-hard ethical subway tile. Fixie paleo intelligentsia pabst. Ennui waistcoat vinyl gochujang. Poutine salvia authentic affogato, chambray lumbersexual shabby chic.</p>
<h3 id="contact-info">Contact Info</h3>
<p>Plaid hell of cred microdosing, succulents tilde pour-over. Offal shabby chic 3 wolf moon blue bottle raw denim normcore poutine pork belly.</p>
<h3 id="external-links">External Links</h3>
<p>Stumptown PBR&amp;B keytar plaid street art, forage XOXO pitchfork selvage affogato green juice listicle pickled everyday carry hashtag. Organic sustainable letterpress sartorial scenester intelligentsia swag bushwick. Put a bird on it stumptown neutra locavore. IPhone typewriter messenger bag narwhal. Ennui cold-pressed seitan flannel keytar, single-origin coffee adaptogen occupy yuccie williamsburg chillwave shoreditch forage waistcoat.</p>
<pre><code>This is the final element on the page and there should be no margin below this.
</code></pre>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8df6ea6904416b571ff9bc73afb50933">9 - Reference</h1>
    <div class="lead">Low level reference docs for your project.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page that shows you how to use this template site.</p>

</div>

<p>If your project has an API, configuration, or other reference - anything that users need to look up that’s at an even lower level than a single task - put (or link to it) here. You can serve and link to generated reference docs created using Doxygen,
Javadoc, or other doc generation tools by putting them in your <code>static/</code> directory. Find out more in <a href="https://docsy.dev/docs/adding-content/content/#adding-static-content">Adding static content</a>. For OpenAPI reference, Docsy also provides a <a href="https://www.docsy.dev/docs/adding-content/shortcodes/#swaggerui">Swagger UI layout and shortcode</a> that renders <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a> using any OpenAPI YAML or JSON file as source.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fae1ff8e3c30cfdbe85045f64e0a7b36">9.1 - Parameter Reference</h1>
    <div class="lead">A short lead description about this content page. It can be <strong>bold</strong> or <em>italic</em> and can be split over multiple paragraphs.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page. Replace it with your own content.</p>

</div>

<p>Text can be <strong>bold</strong>, <em>italic</em>, or <del>strikethrough</del>. <a href="https://gohugo.io">Links</a> should be blue with no underlines (unless hovered over).</p>
<p>There should be whitespace between paragraphs. Vape migas chillwave sriracha poutine try-hard distillery. Tattooed shabby chic small batch, pabst art party heirloom letterpress air plant pop-up. Sustainable chia skateboard art party banjo cardigan normcore affogato vexillologist quinoa meggings man bun master cleanse shoreditch readymade. Yuccie prism four dollar toast tbh cardigan iPhone, tumblr listicle live-edge VHS. Pug lyft normcore hot chicken biodiesel, actually keffiyeh thundercats photo booth pour-over twee fam food truck microdosing banh mi. Vice activated charcoal raclette unicorn live-edge post-ironic. Heirloom vexillologist coloring book, beard deep v letterpress echo park humblebrag tilde.</p>
<p>90&rsquo;s four loko seitan photo booth gochujang freegan tumeric listicle fam ugh humblebrag. Bespoke leggings gastropub, biodiesel brunch pug fashion axe meh swag art party neutra deep v chia. Enamel pin fanny pack knausgaard tofu, artisan cronut hammock meditation occupy master cleanse chartreuse lumbersexual. Kombucha kogi viral truffaut synth distillery single-origin coffee ugh slow-carb marfa selfies. Pitchfork schlitz semiotics fanny pack, ugh artisan vegan vaporware hexagon. Polaroid fixie post-ironic venmo wolf ramps <strong>kale chips</strong>.</p>
<blockquote>
<p>There should be no margin above this first sentence.</p>
<p>Blockquotes should be a lighter gray with a border along the left side in the secondary color.</p>
<p>There should be no margin below this final sentence.</p>
</blockquote>
<h2 id="first-header-2">First Header 2</h2>
<p>This is a normal paragraph following a header. Knausgaard kale chips snackwave microdosing cronut copper mug swag synth bitters letterpress glossier <strong>craft beer</strong>. Mumblecore bushwick authentic gochujang vegan chambray meditation jean shorts irony. Viral farm-to-table kale chips, pork belly palo santo distillery activated charcoal aesthetic jianbing air plant woke lomo VHS organic. Tattooed locavore succulents heirloom, small batch sriracha echo park DIY af. Shaman you probably haven&rsquo;t heard of them copper mug, crucifix green juice vape <em>single-origin coffee</em> brunch actually. Mustache etsy vexillologist raclette authentic fam. Tousled beard humblebrag asymmetrical. I love turkey, I love my job, I love my friends, I love Chardonnay!</p>
<p>Deae legum paulatimque terra, non vos mutata tacet: dic. Vocant docuique me plumas fila quin afuerunt copia haec o neque.</p>
<p>On big screens, paragraphs and headings should not take up the full container width, but we want tables, code blocks and similar to take the full width.</p>
<p>Scenester tumeric pickled, authentic crucifix post-ironic fam freegan VHS pork belly 8-bit yuccie PBR&amp;B. <strong>I love this life we live in</strong>.</p>
<h2 id="second-header-2">Second Header 2</h2>
<blockquote>
<p>This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.</p>
</blockquote>
<h3 id="header-3">Header 3</h3>
<pre><code>This is a code block following a header.
</code></pre><p>Next level leggings before they sold out, PBR&amp;B church-key shaman echo park. Kale chips occupy godard whatever pop-up freegan pork belly selfies. Gastropub Belinda subway tile woke post-ironic seitan. Shabby chic man bun semiotics vape, chia messenger bag plaid cardigan.</p>
<h4 id="header-4">Header 4</h4>
<ul>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
<li>This is an unordered list following a header.</li>
</ul>
<h5 id="header-5">Header 5</h5>
<ol>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
<li>This is an ordered list following a header.</li>
</ol>
<h6 id="header-6">Header 6</h6>
<table>
<thead>
<tr>
<th>What</th>
<th>Follows</th>
</tr>
</thead>
<tbody>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
<tr>
<td>A table</td>
<td>A header</td>
</tr>
</tbody>
</table>
<hr>
<p>There&rsquo;s a horizontal rule above and below this.</p>
<hr>
<p>Here is an unordered list:</p>
<ul>
<li>Liverpool F.C.</li>
<li>Chelsea F.C.</li>
<li>Manchester United F.C.</li>
</ul>
<p>And an ordered list:</p>
<ol>
<li>Michael Brecker</li>
<li>Seamus Blake</li>
<li>Branford Marsalis</li>
</ol>
<p>And an unordered task list:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Create a Hugo theme</li>
<li><input checked="" disabled="" type="checkbox"> Add task lists to it</li>
<li><input disabled="" type="checkbox"> Take a vacation</li>
</ul>
<p>And a &ldquo;mixed&rdquo; task list:</p>
<ul>
<li><input disabled="" type="checkbox"> Pack bags</li>
<li>?</li>
<li><input disabled="" type="checkbox"> Travel!</li>
</ul>
<p>And a nested list:</p>
<ul>
<li>Jackson 5
<ul>
<li>Michael</li>
<li>Tito</li>
<li>Jackie</li>
<li>Marlon</li>
<li>Jermaine</li>
</ul>
</li>
<li>TMNT
<ul>
<li>Leonardo</li>
<li>Michelangelo</li>
<li>Donatello</li>
<li>Raphael</li>
</ul>
</li>
</ul>
<p>Definition lists can be used with Markdown syntax. Definition headers are bold.</p>
<dl>
<dt>Name</dt>
<dd>Godzilla</dd>
<dt>Born</dt>
<dd>1952</dd>
<dt>Birthplace</dt>
<dd>Japan</dd>
<dt>Color</dt>
<dd>Green</dd>
</dl>
<hr>
<p>Tables should have bold headings and alternating shaded rows.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
</tr>
</tbody>
</table>
<p>If a table is too wide, it should scroll horizontally.</p>
<table>
<thead>
<tr>
<th>Artist</th>
<th>Album</th>
<th>Year</th>
<th>Label</th>
<th>Awards</th>
<th>Songs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Michael Jackson</td>
<td>Thriller</td>
<td>1982</td>
<td>Epic Records</td>
<td>Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical</td>
<td>Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life</td>
</tr>
<tr>
<td>Prince</td>
<td>Purple Rain</td>
<td>1984</td>
<td>Warner Brothers Records</td>
<td>Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&amp;B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal</td>
<td>Let&rsquo;s Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I&rsquo;m a Star, Purple Rain</td>
</tr>
<tr>
<td>Beastie Boys</td>
<td>License to Ill</td>
<td>1986</td>
<td>Mercury Records</td>
<td>noawardsbutthistablecelliswide</td>
<td>Rhymin &amp; Stealin, The New Style, She&rsquo;s Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill</td>
</tr>
</tbody>
</table>
<hr>
<p>Code snippets like <code>var foo = &quot;bar&quot;;</code> can be shown inline.</p>
<p>Also, <code>this should vertically align</code> <del><code>with this</code></del> <del>and this</del>.</p>
<p>Code can also be shown in a block element.</p>
<pre><code>foo := &quot;bar&quot;;
bar := &quot;foo&quot;;
</code></pre><p>Code can also use syntax highlighting.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">input</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">`var foo = &#34;bar&#34;;`</span>

  <span style="color:#000">lexer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;javascript&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">lexer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tokenise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">styles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;github&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLineNumbers</span><span style="color:#000;font-weight:bold">())</span>

  <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buff</span> <span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
  <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">style</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">iterator</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buff</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><pre><code>Long, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.
</code></pre><p>Inline code inside table cells should still be distinguishable.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javascript</td>
<td><code>var foo = &quot;bar&quot;;</code></td>
</tr>
<tr>
<td>Ruby</td>
<td><code>foo = &quot;bar&quot;{</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Small images should be shown at their actual size.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/240px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p>Large images should always scale down and fit in the content container.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg/1024px-Picea_abies_shoot_with_buds%2C_Sogndal%2C_Norway.jpg" alt=""></p>
<p><em>The photo above of the Spruce Picea abies shoot with foliage buds: Bjørn Erik Pedersen, CC-BY-SA.</em></p>
<h2 id="components">Components</h2>
<h3 id="alerts">Alerts</h3>
<p>

<div class="alert alert-primary" role="alert">


    This is an alert.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This is an alert with a title and <strong>Markdown</strong>.

</div>



<div class="alert alert-success" role="alert">


    This is a successful alert.

</div>



<div class="alert alert-warning" role="alert">


    This is a warning.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This is a warning with a title.

</div>
</p>
<h2 id="another-heading">Another Heading</h2>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8efbf7499fe9c7bde8d2c1bb7ff6ee3c">10 - Contribution Guidelines</h1>
    <div class="lead">How to contribute to the docs</div>
	

<div class="pageinfo pageinfo-primary">
<p>These basic sample guidelines assume that your Docsy site is deployed using Netlify and your files are stored in GitHub. You can use the guidelines &ldquo;as is&rdquo; or adapt them with your own instructions: for example, other deployment options, information about your doc project&rsquo;s file structure, project-specific review guidelines, versioning guidelines, or any other information your users might find useful when updating your site. <a href="https://github.com/kubeflow/website/blob/master/README.md">Kubeflow</a> has a great example.</p>
<p>Don&rsquo;t forget to link to your own doc repo rather than our example site! Also make sure users can find these guidelines from your doc repo README: either add them there and link to them from this page, add them here and link to them from the README, or include them in both locations.</p>

</div>

<p>We use <a href="https://gohugo.io/">Hugo</a> to format and generate our website, the
<a href="https://github.com/google/docsy">Docsy</a> theme for styling and site structure,
and <a href="https://www.netlify.com/">Netlify</a> to manage the deployment of the site.
Hugo is an open-source static site generator that provides us with templates,
content organisation in a standard directory structure, and a website generation
engine. You write the pages in Markdown (or HTML if you want), and Hugo wraps them up into a website.</p>
<p>All submissions, including submissions by project members, require review. We
use GitHub pull requests for this purpose. Consult
<a href="https://help.github.com/articles/about-pull-requests/">GitHub Help</a> for more
information on using pull requests.</p>
<h2 id="quick-start-with-netlify">Quick start with Netlify</h2>
<p>Here&rsquo;s a quick guide to updating the docs. It assumes you&rsquo;re familiar with the
GitHub workflow and you&rsquo;re happy to use the automated preview of your doc
updates:</p>
<ol>
<li>Fork the <a href="https://github.com/google/docsy-example">Goldydocs repo</a> on GitHub.</li>
<li>Make your changes and send a pull request (PR).</li>
<li>If you&rsquo;re not yet ready for a review, add &ldquo;WIP&rdquo; to the PR name to indicate
it&rsquo;s a work in progress. (<strong>Don&rsquo;t</strong> add the Hugo property
&ldquo;draft = true&rdquo; to the page front matter, because that prevents the
auto-deployment of the content preview described in the next point.)</li>
<li>Wait for the automated PR workflow to do some checks. When it&rsquo;s ready,
you should see a comment like this: <strong>deploy/netlify — Deploy preview ready!</strong></li>
<li>Click <strong>Details</strong> to the right of &ldquo;Deploy preview ready&rdquo; to see a preview
of your updates.</li>
<li>Continue updating your doc and pushing your changes until you&rsquo;re happy with
the content.</li>
<li>When you&rsquo;re ready for a review, add a comment to the PR, and remove any
&ldquo;WIP&rdquo; markers.</li>
</ol>
<h2 id="updating-a-single-page">Updating a single page</h2>
<p>If you&rsquo;ve just spotted something you&rsquo;d like to change while using the docs, Docsy has a shortcut for you:</p>
<ol>
<li>Click <strong>Edit this page</strong> in the top right hand corner of the page.</li>
<li>If you don&rsquo;t already have an up to date fork of the project repo, you are prompted to get one - click <strong>Fork this repository and propose changes</strong> or <strong>Update your Fork</strong> to get an up to date version of the project to edit. The appropriate page in your fork is displayed in edit mode.</li>
<li>Follow the rest of the <a href="#quick-start-with-netlify">Quick start with Netlify</a> process above to make, preview, and propose your changes.</li>
</ol>
<h2 id="previewing-your-changes-locally">Previewing your changes locally</h2>
<p>If you want to run your own local Hugo server to preview your changes as you work:</p>
<ol>
<li>
<p>Follow the instructions in <a href="/docs/getting-started">Getting started</a> to install Hugo and any other tools you need. You&rsquo;ll need at least <strong>Hugo version 0.45</strong> (we recommend using the most recent available version), and it must be the <strong>extended</strong> version, which supports SCSS.</p>
</li>
<li>
<p>Fork the <a href="https://github.com/google/docsy-example">Goldydocs repo</a> repo into your own project, then create a local copy using <code>git clone</code>. Don’t forget to use <code>--recurse-submodules</code> or you won’t pull down some of the code you need to generate a working site.</p>
<pre><code>git clone --recurse-submodules --depth 1 https://github.com/google/docsy-example.git
</code></pre></li>
<li>
<p>Run <code>hugo server</code> in the site root directory. By default your site will be available at http://localhost:1313/. Now that you&rsquo;re serving your site locally, Hugo will watch for changes to the content and automatically refresh your site.</p>
</li>
<li>
<p>Continue with the usual GitHub workflow to edit files, commit them, push the
changes up to your fork, and create a pull request.</p>
</li>
</ol>
<h2 id="creating-an-issue">Creating an issue</h2>
<p>If you&rsquo;ve found a problem in the docs, but you&rsquo;re not sure how to fix it yourself, please create an issue in the <a href="https://github.com/google/docsy-example/issues">Goldydocs repo</a>. You can also create an issue about a specific page by clicking the <strong>Create Issue</strong> button in the top right hand corner of the page.</p>
<h2 id="useful-resources">Useful resources</h2>
<ul>
<li><a href="https://www.docsy.dev/docs/">Docsy user guide</a>: All about Docsy, including how it manages navigation, look and feel, and multi-language support.</li>
<li><a href="https://gohugo.io/documentation/">Hugo documentation</a>: Comprehensive reference for Hugo.</li>
<li><a href="https://guides.github.com/activities/hello-world/">Github Hello World!</a>: A basic introduction to GitHub concepts and workflow.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User mailing list" aria-label="User mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:user@avro.apache.org" aria-label="User mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/ApacheAvro" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://stackoverflow.com/questions/tagged/avro" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/apache/avro" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Chat with other project developers at Slack #avro" aria-label="Chat with other project developers at Slack #avro">
    <a class="text-white" target="_blank" rel="noopener" href="https://the-asf.slack.com/" aria-label="Chat with other project developers at Slack #avro">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:dev@avro.apache.org" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The Apache Software Foundation All Rights Reserved</small>
	
      <p><small class="text-white">Apache, Avro and Hadoop are registered trademarks of the Apache Software Foundation in the United States and other countries.</small></p>
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




 












<script src="/js/main.min.c9d38a7b22e0ae74de7c8d1ceab8db3426db136c364062c92f3c2b8d4bd669d4.js" integrity="sha256-ydOKeyLgrnTefI0c6rjbNCbbE2w2QGLJLzwrjUvWadQ=" crossorigin="anonymous"></script>



<script src='/js/prism.js'></script>





  </body>
</html>
